( Solo Forth worbench disk )                                    \ http://programandala.net/en.program.solo_forth.html                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( sqrt-bench )                                                  need baden-sqrt need newton-sqrt need bench{ need }bench.       : run ( u -- )                                                    cls ." Results for " dup u. ." iterations"                      dup cr ." baden-sqrt :" cr space                                bench{ 0 ?do i abs baden-sqrt  drop loop }bench.                    cr ." newton-sqrt   :" cr space                             bench{ 0 ?do i abs newton-sqrt drop loop }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( orthodraw-bench ortholine-bench )                             need orthodraw need ortholine need bench{ need }bench.          : run ( u -- )                                                    cls ." Results for " dup u. ." iterations"                      dup cr ." orthodraw :" cr space                                 bench{ 0 ?do  0 0 1 1 100 orthodraw loop }bench.                    cr ." ortholine :" cr space                                 bench{ 0 ?do  0 0 1 1 100 ortholine  loop }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( ink-bench )                                                   need bench{ need }bench.                                        need ink. need set-ink need attr@ need attr!                    : old-set-ink ( b -- ) attr@ %11111000 and or attr! ;           : run ( u -- )                                                    cr ." Bench of ink "                                            cr ." Results for " dup u. ." iterations"                       dup cr ." ink. :" cr space                                      bench{ 0 ?do  i ink.         loop default-colors }bench.        dup cr ." set-ink in Forth :" cr space                          bench{ 0 ?do  i old-set-ink  loop default-colors }bench.            cr ." set-ink in Z80 :" cr space                            bench{ 0 ?do  i set-ink      loop default-colors }bench. ;                                                                                                                                                                                                    ( paper-bench )                                                 need bench{ need }bench.                                        need paper. need set-paper need papery                          need attr@ need attr!                                           : old-set-paper ( b -- )                                          papery attr@ %11000111 and or attr! ;                         : run ( u -- )                                                    cr ." Bench of paper "                                          cr ." Results for " dup u. ." iterations"                       dup cr ." paper. :" cr space                                    bench{ 0 ?do  i paper.         loop default-colors }bench.      dup cr ." set-paper in Forth :" cr space                        bench{ 0 ?do  i old-set-paper  loop default-colors }bench.          cr ." set-paper in Z80 :" cr space                          bench{ 0 ?do  i set-paper      loop default-colors }bench. ;                                                                  ( circle-bench )                                                need bench{ need }bench.                                        need circle                                                     need colored-circle-pixel need uncolored-circle-pixel           need frames@ need reset-frames  defer (number-base)             : (run) ( u -- )                                                  bench{ 0 ?do  127 95 95 circle  loop }bench. ;                : run ( u -- )                                                    cr ." Bench of circle "                                         cr ." Results for " dup u. ." iterations"                       dup cr ." With colored-circle-pixel :" cr space                     colored-circle-pixel set-circle-pixel (run)                     cr ." With uncolored-circle-pixel :" cr space                   uncolored-circle-pixel set-circle-pixel (run) ;                                                                                                                                           ( mask+attr!-bench )                                            need bench{ need }bench.                                        need attr! need attr-mask! need os-attr-t need mask+attr!       4 cconstant green                                               : v1 ( x1 x2 -- ) attr! attr-mask! ;                            : v2 ( x1 x2 -- ) os-attr-t 2! ;                                : v3 ( x1 x2 -- ) mask+attr! ;                                  : run ( u -)                                                      cr ." Bench of mask+attr! "                                     cr ." Results for " dup u. ." iterations"                       dup cr ." Variant 1: "                                          bench{ 0 ?do  0 green v1  loop }bench.                          dup cr ." Variant 2: "                                          bench{ 0 ?do  0 green v2  loop }bench.                              cr ." Variant 3: "                                          bench{ 0 ?do  0 green v3  loop }bench. ;                      ( -beep>note-bench )                                            need bench{ need }bench. need under+                            12 cconstant /octave                                            : -beep>note1 ( n1 -- -n2 +n3 )                                   dup 1+ /octave / 1- tuck ( n2 n1 n2 )                           1+ /octave * - /octave + ;                                    : -beep>note2 ( n1 -- -n2 +n3 )                                   dup 1+ /octave / tuck ( n2' n1 n2' )                            /octave * - /octave +  swap 1- swap ;                         : -beep>note3 ( n1 -- -n2 +n3 )                                   dup 1+ /octave / tuck ( n2' n1 n2' )                            /octave * - /octave +  -1 under+ ;                            : -beep>note4 ( n1 -- -n2 +n3 )                                   abs [ /octave 1- ] literal +                                    /octave /mod negate [ /octave 1- ] literal rot - ;  -->                                                                       ( -beep>note-bench )                                            : run ( u -)                                                      cr ." Bench of -beep>note"                                      cr ." Results for " dup u. ." iterations"                       dup cr ." Variant 1: "                                          bench{ 0 ?do  i -beep>note1 2drop  loop }bench.                 dup cr ." Variant 2: "                                          bench{ 0 ?do  i -beep>note2 2drop  loop }bench.                 dup cr ." Variant 3: "                                          bench{ 0 ?do  i -beep>note3 2drop  loop }bench.                     cr ." Variant 4: "                                          bench{ 0 ?do  i -beep>note4 2drop  loop }bench. ;                                                                                                                                                                                                                                                                             ( hz>bleep-bench )                                              need bench{ need }bench.                                        : hz>bleep1 ( frequency duration1 -- duration2 pitch )            over 1000 */ swap  4375 100 rot */ 30 - ;                     : hz>bleep2 ( frequency duration1 -- duration2 pitch )            over m* 1000 m/ nip swap  437500. rot m/ nip 30 - ;           : run ( u -)                                                      cr ." Bench of hz>bleep"                                        cr ." Results for " dup u. ." iterations" dup                   cr ." with */        : "                                        bench{ 0 ?do  i dup hz>bleep1 2drop  loop }bench.               cr ." with m* and m/ : "                                        bench{ 0 ?do  i dup hz>bleep2 2drop  loop }bench. ;                                                                                                                                                                                                           ( 1/string-bench )                                              need bench{ need }bench.                                        : run ( u -)                                                      cr ." Results for " dup u. ." iterations" dup                   cr ." 1 /string : "                                             bench{ 0 ?do  0 0 1 /string 2drop  loop }bench.                 cr ." 1/string  : "                                             bench{ 0 ?do  0 0 1/string  2drop  loop }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( substitute-bench )                                            need bench{ need }bench.                                        need substitute need substitute2 need replaces                  create result 255 chars allot                                   s" saluton"  s" hello"    replaces                              s" bonvenon" s" welcome"  replaces                              : old ( -- ca len )                                               s" Say '%hello%' and '%welcome%' then percentage sign %%." ;  result 255 2constant new                                        : run ( u -)                                                      cr ." Results for " dup u. ." iterations" dup                   cr ." substitute w/rot :      "                                 bench{ 0 ?do  old new substitute  drop 2drop  loop }bench.      cr ." substitute w/variable : "                                 bench{ 0 ?do  old new substitute2 drop 2drop  loop }bench. ;                                                                  ( >name-bench )                                                 need bench{ need }bench.                                        need >>name need name>> need name>name                          : >name2 ( xt -- nt | 0 )                                         0 begin ( xt xtp )                                                dup >>name >r  far@ over = if  drop r> exit  then               r> name>name name>>                                           np@ over u< until  2drop false ;                              : run ( u -)                                                      cr ." Results for " dup u. ." iterations"                       dup cr ." >name in Z80:   "                                         bench{ 0 ?do  latestxt >name  drop  loop }bench.                cr ." >name in Forth: "                                         bench{ 0 ?do  latestxt >name2 drop  loop }bench. ;                                                                                                                                        ( m*-bench )                                                    need bench{ need }bench. need d*                                : km* ( n1 n2 - d) 2dup xor >r abs swap abs um* r> ?dnegate ;   : lm* ( n1 n2 - d) >r s>d r> s>d d* ;                           : run ( u -)                                                      cr ." Results for " dup u. ." iterations"                       dup cr ." Kernel m*: "                                              bench{ 0 ?do  i i km* 2drop  loop }bench.                       cr ." Library m*: "                                             bench{ 0 ?do  i i lm* 2drop  loop }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                               ( dot-quote-bench )                                             need bench{ need }bench need bench.                             need column need row need .\"                                   : run ( u -- )                                                    cr ." Results for " dup u. ." iterations"                       cr ." 'X' emit : "    column row 2>r                            dup bench{ 0 ?do  home 'X' emit       loop }bench               2r> at-xy bench.                                                cr .\" .\" X\"    : " column row 2>r                                bench{ 0 ?do  home ." X"          loop }bench               2r> at-xy bench. ;                                                                                                                                                                                                                                                                                                                                                                            ( at-xy-display-0udg-bench )                                    need bench{ need }bench.                                        need at-xy-display-0udg ( c x y -- )                            need 0udg-at-xy-display ( x y c -- )                            : run ( u -- )                                                    cr ." Results for " dup u. ." iterations"                       dup cr ." at-xy-display-0udg: "                                 dup bench{ 0 ?do  0 0 0 at-xy-display-0udg  loop }bench.            cr ." 0udg-at-xy-display: "                                     bench{ 0 ?do  0 0 0 0udg-at-xy-display  loop }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                    ( aline176-bench )                                              need bench{ need }bench. need adraw176 need aline176            : adraw ( -- )   0 175 adraw176 255 175 adraw176                                 255   0 adraw176   0   0 adraw176 ;            : aline ( -- )   0 175 aline176 255 175 aline176                                 255   0 aline176   0   0 aline176 ;            : run ( u -- )                                                    cr ." Results for " dup u. ." iterations"                       dup cr ." adraw176: "                                               0 swap bench{ 0 ?do  adraw  loop }bench. drop                   cr ." aline176: "                                               0 swap bench{ 0 ?do  aline  loop }bench. drop ;                                                                                                                                                                                                                                                                           ( +field-bench )                                                need bench{ need }bench.                                        : +field-cr ( n1 n2 "name" -- n3 )                                create  over , +  does> @ + ;                                 : +field-co ( n1 n2 "name" -- n3 )                                :                                                               over ?dup if    postpone literal postpone +                               else  immediate  then  postpone ;  + ;              -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( +field-bench )                                                need case                                                       : +field-ca ( n1 n2 "name" -- n3 )                                :                                                               over case                                                       0                   of  immediate                      endof    1                   of  postpone 1+                    endof    cell                of  postpone cell+                 endof    [ 2 cells ] literal of  postpone cell+ postpone cell+  endof    dup  postpone literal postpone +  \ default                     endcase  postpone ;  + ;                                      $0000 1 +field-cr 0f-cr drop                                    $0000 1 +field-co 0f-co drop                                    $0000 1 +field-ca 0f-ca drop  -->                                                                                                                                                               ( +field-bench )                                                $0001 1 +field-cr 1f-cr drop                                    $0001 1 +field-co 1f-co drop                                    $0001 1 +field-ca 1f-ca drop                                    $0002 1 +field-cr 2f-cr drop                                    $0002 1 +field-co 2f-co drop                                    $0002 1 +field-ca 2f-ca drop                                    $0004 1 +field-cr 4f-cr drop                                    $0004 1 +field-co 4f-co drop                                    $0004 1 +field-ca 4f-ca drop                                    $0005 1 +field-cr 5f-cr drop                                    $0005 1 +field-co 5f-co drop                                    $0005 1 +field-ca 5f-ca drop  -->                                                                                                                                                                                                                               ( +field-bench )                                                : run ( u -- )                                                    cls ." +field benchmark"                                        ." Results for " dup u. ." iterations"                          cr ." Field 0:"     cr ." - 'create'    "                       dup bench{ 0 ?do  0 0f-cr drop  loop }bench.                                        cr ." - '+'         "                       dup bench{ 0 ?do  0 0f-co drop  loop }bench.                                        cr ." - 'case'      "                       dup bench{ 0 ?do  0 0f-ca drop  loop }bench.                    cr ." Field non-0:" cr ." - +1 'create' "                       dup bench{ 0 ?do  0 1f-cr drop  loop }bench.                                        cr ." - +1 '+'      "                       dup bench{ 0 ?do  0 1f-co drop  loop }bench.                                        cr ." - +1 'case'   "                       dup bench{ 0 ?do  0 1f-ca drop  loop }bench.  -->             ( +field-bench )                                                                      cr ." - +2 'create' "                       dup bench{ 0 ?do  0 2f-cr drop  loop }bench.                                        cr ." - +2 '+'      "                       dup bench{ 0 ?do  0 2f-co drop  loop }bench.                                        cr ." - +2 'case'   "                       dup bench{ 0 ?do  0 2f-ca drop  loop }bench.                                        cr ." - +4 'create' "                       dup bench{ 0 ?do  0 4f-cr drop  loop }bench.                                        cr ." - +4 '+'      "                       dup bench{ 0 ?do  0 4f-co drop  loop }bench.                                        cr ." - +4 'case'   "                       dup bench{ 0 ?do  0 4f-ca drop  loop }bench.  -->                                                                                                                                                                                                             ( +field-bench )                                                                      cr ." - +5 'create' "                       dup bench{ 0 ?do  0 5f-cr drop  loop }bench.                                        cr ." - +5 '+'      "                       dup bench{ 0 ?do  0 5f-co drop  loop }bench.                                        cr ." - +5 'case'   "                           bench{ 0 ?do  0 5f-ca drop  loop }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( transfer-bench  )                                             need bench{ need }bench.                                        : constsum ( -- n ) buffer-data b/sector + ;                    : litsum ( -- n ) [ buffer-data b/sector + ] literal ;          : run ( u -- )                                                    cr ." Results for " dup u. ." iterations"                       dup cr ." constants sum "                                           0 swap bench{ 0 ?do  constsum drop  loop }bench. drop           cr ." literal       "                                           0 swap bench{ 0 ?do  litsum drop    loop }bench. drop ;                                                                                                                                                                                                                                                                                                                                                                                                   ( 2cells+-bench )                                               need bench{ need }bench.                                        : cell+cell+ ( n -- ) cell+ cell+ ;                             : 2cellslit+ ( n -- ) [ 2 cells ] literal + ;                   : run ( u -- )                                                    cr ." Results for " dup u. ." iterations"                       dup cr ." cell+ cell+ "                                             0 swap bench{ 0 ?do  cell+cell+  loop }bench. drop              cr ." 4 +         "                                             0 swap bench{ 0 ?do  2cellslit+  loop }bench. drop ;                                                                                                                                                                                                                                                                                                                                                                                                      ( number-base-bench )                                           : number-base-1 ( ca len -- ca' len' n )                          over c@ '$' = if  1 /string 16  exit  then                      over c@ '%' = if  1 /string  2  exit  then                      over c@ '#' = if  1 /string 10  exit  then  base @ ;          : number-base-2 ( ca len -- ca' len' n )                          over c@ >r                                                      r@ '$' = if  1 /string 16  rdrop exit  then                     r@ '%' = if  1 /string  2  rdrop exit  then                     r> '#' = if  1 /string 10  exit  then  base @ ;               : number-base-3 ( ca len -- ca' len' n )                          over c@                                                         dup >r '$' = if  1 /string 16  rdrop exit  then                     r@ '%' = if  1 /string  2  rdrop exit  then                     r> '#' = if  1 /string 10  exit  then  base @ ;           -->                                                             ( number-base-bench )                                           : number-base-4 ( ca len -- ca' len' n )                          over c@                                                         dup '$' = if  drop 1 /string 16  exit  then                     dup '%' = if  drop 1 /string  2  exit  then                         '#' = if  1 /string 10  exit  then  base @ ;              need frames@ need reset-frames  defer (number-base)             : (number-base-bench) ( n xt -- )                                 ['] (number-base) defer!                                        reset-frames  0 ?do  s" 000" (number-base) drop 2drop  loop     frames@ d. cr ;                                               : number-base-bench ( u -- )                                      dup ['] number-base-1 (number-base-bench)                       dup ['] number-base-2 (number-base-bench)                       dup ['] number-base-3 (number-base-bench)                           ['] number-base-4 (number-base-bench) ;                   ( fill-bench )                                                  need frames@ need reset-frames need rnd                         defer (fill)                                                    : (fill-bench) ( n xt -- )                                        ['] (fill) defer!                                               reset-frames  0                                                 ?do  16384 6144 rnd (fill)  loop                                frames@ cr d.                                                   key drop ;                                                    : fill-bench ( u -- )                                             dup ['] fill (fill-bench)                                       dup ['] fill2 (fill-bench)                                          ['] fill88 (fill-bench) ;                                                                                                                                                                                                                                 ( value-bench 2value-bench variable-bench 2variable-bench )     need value need 2value need bench{ need }bench.                 0 value val1  : value-bench ( u -- )                                            bench{  0 ?do  val1 drop  loop  }bench. ;       0. 2value val2  : 2value-bench ( u -- )                                           bench{  0 ?do  val2 2drop  loop  }bench. ;    variable var1  : variable-bench ( u -- )                                         bench{  0 ?do  var1 @ drop  loop  }bench. ;    2variable var2  : 2variable-bench ( u -- )                                        bench{  0 ?do  var2 2@ 2drop  loop  }bench. ; : run ( u -- )                                                    cr dup ." value     " value-bench cr                               dup ." 2value    " 2value-bench cr                              dup ." variable  " variable-bench cr                                ." 2variable " 2variable-bench cr ;                                                                                    ( fetch-bench )                                                 need value need cvalue need cvariable                           need bench{ need }bench.                                        0 value val  : value-bench ( u -- )                                            bench{  0 ?do  val drop  loop  }bench. ;         0 cvalue cval  : cvalue-bench ( u -- )                                           bench{  0 ?do  cval drop  loop  }bench. ;      variable var  : variable-bench ( u -- )                                         bench{  0 ?do  var @ drop  loop  }bench. ;      cvariable cvar  : cvariable-bench ( u -- )                                        bench{  0 ?do  cvar c@ drop  loop  }bench. ;  : run ( u -- )                                                    cr dup ." value     " value-bench cr                               dup ." cvalue    " cvalue-bench cr                              dup ." variable  " variable-bench cr                                ." cvariable " cvariable-bench cr ;                    ( store-bench )                                                 need value need cvalue need cvariable                           need bench{ need }bench.                                        0 value val  0 cvalue cval  variable var  cvariable cvar        : value-bench ( u -- )                                            bench{  0 ?do  i to val  loop  }bench. ;                      : cvalue-bench ( u -- )                                           bench{  0 ?do  i cto cval  loop  }bench. ;                    : variable-bench ( u -- )                                         bench{  0 ?do  i var !  loop  }bench. ;                       : cvariable-bench ( u -- )                                        bench{  0 ?do  i cvar c!  loop  }bench. ;                     : run ( u -- ) cr dup ." value     " value-bench cr                                 dup ." cvalue    " cvalue-bench cr                              dup ." variable  " variable-bench cr                                ." cvariable " cvariable-bench cr ;     ( to-value-bench to-2value-bench 2to-2value-bench )             need value need 2value need bench{ need }bench.                 0 value v1                                                      : to-value-bench ( u -- )                                         bench{  0 ?do  0 to v1  loop  }bench. ;                       0. 2value v2                                                    : to-2value-bench ( u -- )                                        bench{  0 ?do  0. to v2  loop  }bench. ;                      0. 2value v2                                                    : 2to-2value-bench ( u -- )                                       bench{  0 ?do  0. 2to v2   loop  }bench. ;                                                                                                                                                                                                                                                                                                                                                    ( rshift-bench lshift-bench )                                   need frames@ need reset-frames                                  : rshift-bench ( u -- )                                           reset-frames  0                                                 ?do  128 255 rshift drop   loop                                 frames@ cr d. ;                                               : lshift-bench ( u -- )                                           reset-frames  0                                                 ?do  128 255 lshift drop   loop                                 frames@ cr d. ;                                                                                                                                                                                                                                                                                                                                                                                                                                               ( /-bench )                                                     need frames@ need reset-frames need rnd                         : drnd ( -- d ) rnd rnd ;                                       [defined] (/) ?\ defer (/)                                      : (/-bench) ( n -- )                                              reset-frames                                                    1+ 1 ?do  drnd i (/) 2drop  loop  frames@ cr d. ;             : /-bench ( u -- )                                                dup ['] m/ ['] (/) defer! (/-bench)                                 ['] sm/rem ['] (/) defer! (/-bench) ;                                                                                                                                                                                                                                                                                                                                                                                                                     ( um*-bench um/mod-bench )                                      need bench{ need }bench.                                        [unneeded] um*-bench ?(                                         : run ( u -- )                                                    bench{  0 ?do  i i um* 2drop  loop  }bench. ;                 [unneeded] um/mod-bench ?(                                      : um/mod-bench ( u -- )                                           bench{  0 ?do  i s>d i um/mod 2drop  loop  }bench. ;          : um/mod-bench88 ( n -- )                                         bench{  0 ?do  i s>d i um/mod88 2drop  loop  }bench. ;        : run ( u -- )                                                    dup cr ." Abersoft Forth  U/MOD ..." um/mod-bench                   cr ." Z88 CamelForth UM/MOD ..." um/mod-bench88 ; ?)                                                                                                                                                                                                      ( ud/mod-bench )                                                need bench{                                                     : a-m/mod ( n -- )                                                bench{  0 ?do  i s>d i ud/mod drop 2drop  loop  }bench. ;     : z1-ud/mod ( n -- )                                              bench{  0 ?do  i s>d i ud/mod881 drop 2drop  loop  }bench. ;  : z2-ud/mod ( n -- )                                              bench{  0 ?do  i s>d i ud/mod882 drop 2drop  loop  }bench. ;  : run ( u -- )                                                    dup cr ." Abersoft Forth  M/MOD ..." a-m/mod                    dup cr ." Z88 CamelForth UD/MOD 1..." z1-ud/mod                     cr ." Z88 CamelForth UD/MOD 2..." z2-ud/mod ;                                                                                                                                                                                                                                                                             ( ud/mod-bench )                                                need bench{                                                     : a-m/mod ( n -- )                                                bench{  0 ?do  i s>d i ud/mod drop 2drop  loop  }bench. ;     : z-ud/mod ( n -- )                                               bench{  0 ?do  i s>d i ud/mod88 drop 2drop  loop  }bench. ;   : run ( u -- )                                                        cr ." UD/MOD from:"                                         dup cr ." Abersoft Forth and Gforth ..." a-m/mod                dup cr ." Z88 CamelForth .............." z-ud/mod ;                                                                                                                                                                                                                                                                                                                                                                                                           ( number?-bench )                                               need frames@ need reset-frames                                  : empty-stack ( -- ) sp0 @ sp! ;                                defer num?                                                      : number?-bench ( u -- )                                          reset-frames  0 ?do                                               s" " num?  s" 12345" num?   s" 12345." num?                     s" -12345" num?  s" -12345." num?  empty-stack                loop  frames@ cr d. ;                                         : benchs ( -- )                                                   100 number?-bench 1000 number?-bench 10000 number?-bench ;       ' solo-number? ' num? defer! benchs  \ Solo Forth                                                                                                                                                                                                                                                                            ( number?-bench )                                               need frames@ need reset-frames                                  : empty-stack ( -- ) sp0 @ sp! ;                                defer num?                                                      : number?-bench ( u -- )                                          reset-frames  0 ?do                                               s" " num?  s" 123x45." num?   s" 12345.999x" num?               s" -12345.x" num?  s" -12345.999x" num?                         s" -12345.000.000" num?                                         empty-stack                                                   loop  frames@ cr d. ;                                         : benchs ( -- )                                                   100 number?-bench 1000 number?-bench 10000 number?-bench ;    ' solo-number? ' num? defer! benchs                                                                                                                                                             ( dummy-needed )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( buffer-benchmark-1 )                                            2 load need reset-frames                                        reset-frames                                                    need dummy-needed need dummy-needed need dummy-needed           need dummy-needed need dummy-needed need dummy-needed           need dummy-needed need dummy-needed need dummy-needed           need dummy-needed need dummy-needed need dummy-needed           need dummy-needed need dummy-needed need dummy-needed           need dummy-needed                                               frames@ cr .( Frames ) d. cr                                                                                                                                                                                                                                                                                                                                                                                                                                  ( buffer-benchmark-2 )                                            2 load need reset-frames  reset-frames                          need list need dump need wdump need decode                      need life need hanoi need tt need siderator need pong           need doer need a! need defer need value need editor             need case need times need dtimes need for                       frames@ cr .( Frames ) d. cr                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ( header-benchmark )                                            need bench{ bench{ : w ; : w ; : w ; : w ;                      : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ;     : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; : w ; }bench.   ( header-benchmark )                                            need bench{ blk @ 1+ constant b bench{ b load                   b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load b load  b load b load b load b load b load b load b load b load }bench. ( header-benchmark )                                            : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; : foo ; ( interpret-benchmark )                                           need bench{  bench{                                           1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 sp0 @ sp!    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 sp0 @ sp!    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 sp0 @ sp!    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 sp0 @ sp!    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20                }bench. sp0 @ sp!                                             ( interpret-benchmark )                                           need bench{  bench{                                           : foo  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20       1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;              }bench.                                                       ( interpret-benchmark )                                           need bench{  bench{                                           noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop       }bench.                                                       ( interpret-benchmark )                                           need bench{  bench{                                           : foo noop noop noop noop noop noop noop noop noop noop noop    noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop     noop noop noop noop noop noop noop noop noop noop noop noop ;     }bench.                                                       ( 2constant-bench 2literal-bench )                              need bench{ need }bench.                                        0. 2constant 2zero                                              : 2constant-bench ( u -- )                                        bench{ 0 ?do  2zero 2drop  loop  }bench. ;                    : 2literal-bench ( u -- )                                         bench{ 0 ?do  [ 0. ] 2literal 2drop  loop  }bench. ;          : run ( u -- )                                                    dup cr                                                              ." 2constant " 2constant-bench cr                               ." 2literal  " 2literal-bench cr ;                                                                                                                                                                                                                                                                                                                                                        ( literal-bench cliteral-bench constant-bench cconstant-bench ) need bench{ need }bench.                                        1000 constant thousand  100 cconstant hundred                   : constant-bench ( u -- )                                         bench{ 0 ?do  thousand drop  loop  }bench. ;                  : cconstant-bench ( u -- )                                        bench{ 0 ?do  hundred drop  loop  }bench. ;                   : code-constant-bench ( u -- )                                    bench{ 0 ?do  true drop  loop  }bench. ;                      : literal-bench ( u -- )                                          bench{ 0 ?do  [ 1000 ] literal drop  loop  }bench. ;          : cliteral-bench ( u -- )                                         bench{ 0 ?do  [ 100 ] cliteral drop  loop  }bench. ;          -->                                                                                                                                                                                             ( literal-bench cliteral-bench constant-bench cconstant-bench ) : run ( u -- )                                                    cr                                                              dup ." constant      " constant-bench cr                        dup ." cconstant     " cconstant-bench cr                       dup ." code constant " code-constant-bench cr                   dup ." literal       " literal-bench cr                             ." cliteral      " cliteral-bench cr ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( d*-bench )                                                    : baden-d* ( d1 d2 -- d3 )                                        >r swap >r            ( d1lo d2lo ) ( R: d2hi d1hi )            2dup um* 2swap        ( d1lo*d2lo d1lo d2lo )                   r> * swap r> * + + ; ( d1*d2 ) ( R: )                         need pick need roll                                             : smith-d* ( d1 d2 -- d3 )                                        over 4 pick um*  5 roll 3 roll * +  2swap * + ;               unused                                                          : dx-d* ( d|ud1 d|ud2 -- d|ud3 )                                  >r swap >r 2dup um* rot r> * + rot r> * + ;                   unused - . cr key drop                                          -->                                                                                                                                                                                                                                                             ( d*-bench )                                                    need bench{                                                     : baden-d*-bench ( u -- ) 0 ?do  1. 2. baden-d* 2drop  loop ;   : smith-d*-bench ( u -- ) 0 ?do  1. 2. smith-d* 2drop  loop ;   : dx-d*-bench ( u -- )    0 ?do  1. 2.    dx-d* 2drop  loop ;   : d*-benchs ( -- )                                                page                                                            32767 dup bench{ baden-d*-bench }bench.                               dup bench{ smith-d*-bench }bench.                                   bench{ dx-d*-bench }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                                        ( misc-benchs )                                                 need bench{ need 0if                                            : bench1 ( n -- )                                                 begin  ?dup if  1 - else  exit  then  again ;                 : bench1a ( n -- )                                                begin  ?dup if  1- else  exit  then  again ;                  : bench2 ( n -- )                                                 begin  dup 0= if  drop  exit  then  1-  again ;               : bench2a ( n -- )                                                begin  dup 0if  drop exit  then  1-  again ;                  : bench3 ( n -- )                                                  begin  ?dup 0if  exit  then  1-  again ;                     : misc-benchs ( -- )                                              32767 dup bench{ bench1 }bench.                                       dup bench{ bench2 }bench.                                           bench{ bench3 }bench. ;                             ( 2swap-bench )                                                 need bench{                                                     : 2swap-bench ( -- )                                              32767 0 bench{ 2dup ?do  2swap  loop  }bench. 2drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ( dnegate-bench )                                               need bench{                                                     : dnegate-bench ( -- )                                            32767 0 bench{ 2dup ?do  dnegate  loop  }bench. 2drop ;       : dnegate-bench2 ( -- )                                           32767 0 bench{ 2dup ?do  dnegate2  loop  }bench. 2drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ( ?dup-bench )                                                  need bench{  variable times  40000 times !                      : iterations ( -- n1 n2 ) times @ 0 ;                           : forth-0-?dup-bench ( -- )                                       bench{ iterations ?do  0 ?dup drop  loop  }bench. ;           : z80-0-?dup-bench ( -- )                                         bench{ iterations ?do  0 ?dup80 drop  loop  }bench. ;         : forth-1-?dup-bench ( -- )                                       bench{ iterations ?do  1 ?dup 2drop  loop  }bench. ;          : z80-1-?dup-bench ( -- )                                         bench{ iterations ?do  1 ?dup80 2drop  loop  }bench. ;        : ?dup-bench ( -- )                                               cr ." Forth version:" cr ." 0 ?dup :" forth-0-?dup-bench cr                              ." 1 ?dup :" forth-1-?dup-bench cr        ." Z80 version:"   cr ." 0 ?dup :" z80-0-?dup-bench cr                                ." 1 ?dup :" z80-1-?dup-bench cr ;   ( #spaces-bench )                                               need under+                                                     : #spaces1 ( ca len -- +n )                                       0 rot rot  0 ?do  count bl = 1 and under+  loop  drop ;       : #spaces2 ( ca len -- +n )                                       0 rot rot  bounds ?do  i c@ bl = +  loop  abs ;               : #spaces3 ( ca len -- +n )                                       0 rot rot  0 ?do  count bl = under+  loop  drop abs ;         need bench{                                                     defer #spaces                                                   : #spaces-bench ( u -- )                                          cr bench{  0 ?do  0 32767 #spaces drop  loop  }bench. ;       : run ( u -- )                                                    dup ['] #spaces1 ['] #spaces defer! ." 1..." #spaces-bench      dup ['] #spaces2 ['] #spaces defer! ." 2..." #spaces-bench          ['] #spaces3 ['] #spaces defer! ." 3..." #spaces-bench ;  ( emit-udg-bench )                                              need bench{                                                     : e ( n -- )                                                      bench{ 0 ?do  home 128 emit  loop  }bench. ;                  : eu ( n -- )                                                     bench{ 0 ?do  home 128 emit-udg  loop  }bench. ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( m+-bench )                                                    need bench{ need m+                                             : code-m+-bench ( u -- )                                          bench{  0 ?do  i s>d i m+ 2drop  loop  }bench. ;              unused                                                          : high-m+ ( n -- ) s>d d+ ;                                     unused - cr .( bytes of high M+ ) .                             : high-m+-bench ( d1|ud1 n -- d2|ud2 )                            bench{  0 ?do  i s>d i high-m+ 2drop  loop  }bench. ;         : run ( u -- )                                                    cr dup cr ." Code M+ ..." code-m+-bench                                cr ." High M+ ..." high-m+-bench ;                                                                                                                                                                                                                                                                                     ( du<-bench )                                                   need bench{ need j                                              unused                                                          : dzx-forth-du< ( ud1 ud2 -- f )                                  rot swap 2dup                                                   u<  if  2drop 2drop -1 exit  then                               -   if  2drop 0 exit  then  u< ;                              unused - cr .( DZX-Forth ) . .( bytes)  \ 41                    unused                                                          : m3forth-du< ( ud1 ud2 -- f )                                    rot 2dup = if 2drop u< else u> nip nip then ;                 unused - cr .( m3forth ) . .( bytes)  \ 29                      -->                                                                                                                                                                                                                                                             ( du<-bench )                                                   defer (u<)                                                      : du<-bench ( u xt -- )                                           ['] (u<) defer!                                                 bench{                                                            dup 0 ?do  0 ?do  i s>d j s>d (u<) drop  loop  loop           }bench. ;                                                     : run ( u -- )                                                        cr ." DU< from:"                                            dup cr ." DZX-Forth ..." ['] dzx-forth-du< du<-bench                cr ." 3mforth ....." ['] m3forth-du< du<-bench ;                                                                                                                                                                                                                                                                                                                                          ( m*/-bench )                                                   unused                                                          : gforth-m*/ ( d1 n1 +n2 -- d2 )                                  >r s>d >r abs -rot s>d r> xor r> swap >r >r dabs                rot tuck um* 2swap um* swap                                     >r 0 d+ r> -rot i um/mod -rot r> um/mod -rot r>                 if     if     1 0 d+                                                   then                                                            dnegate                                                  else   drop                                                     then ;                                                        unused - cr .( Gforth ) . .( bytes)  \ 89 bytes                 -->                                                                                                                                                                                                                                                             ( m*/-bench )                                                   unused                                                          need mt* need tnegate need ut/                                  unused                                                          : coldforth-m*/ ( d1 n1 +n2 -- d2 )                                 >r mt* dup 0< if    tnegate r> ut/ dnegate                                    else  r> ut/  then ;                                   cr .( Coldforth:)                                      unused - cr .( m*/ only ) . .( bytes)  \ 33 bytes               unused - cr .( with requirements) . .( bytes)  \ 185 bytes      -->                                                                                                                                                                                                                                                                                                                                                                                             ( m*/-bench )                                                   need bench{                                                     defer (m*/)                                                     : m*/-bench ( u xt -- )                                           ['] (m*/) defer!                                                bench{                                                            1+ 1 ?do  i s>d i i (m*/) 2drop  loop                         }bench. ;                                                     : run ( u -- )                                                        cr ." M*/ from:"                                            dup cr ." Gforth ......" ['] gforth-m*/ m*/-bench                   cr ." ColdForth ..." ['] coldforth-m*/ m*/-bench ;                                                                                                                                                                                                                                                                        ( u<-bench )                                                    need bench{ need j                                              defer (u<)                                                      variable times                                                  : u<-bench ( u xt -- )                                            ['] (u<) defer!  times !                                        bench{                                                            times @ 0 ?do  times @ 0 ?do  i j                               (u<) drop  loop  loop                                         }bench. ;                                                     : run ( u -- )                                                        cr ." Implementation of U<"                                 dup cr ."   DZX-Forth .........." ['] u< u<-bench                   cr ."   Z88 CamelForth ....." ['] z88u< u<-bench ;                                                                                                                                        ( u<=-bench u>=-bench )                                         need alias need alias! need j need bench{ need }bench.          : 0(u<=) ( u1 u2 -- f ) u> 0= ;                                 : 1(u<=) ( u1 u2 -- f ) 1+ u< ;                                 : 0(u>=) ( u1 u2 -- f ) u< 0= ;                                 : 1(u>=) ( u1 u2 -- f ) 1- u> ;                                 ' drop alias operator                                           latest constant operator-nt                                     variable times                                                  : operator-bench ( u xt -- )                                      operator-nt alias!  times !                                     bench{                                                            times @ 0 ?do  times @ 0 ?do  i j operator drop  loop  loop   }bench. ;                                                     -->                                                                                                                             ( u<=-bench u>=-bench )                                         : run ( u -- )                                                        cr ." Implementation of U<="                                dup cr ."   u> 0= ..." ['] 0(u<=) operator-bench                dup cr ."   1+ u< ..." ['] 1(u<=) operator-bench                    cr ." Implementation of U>="                                dup cr ."   u< 0= ..." ['] 0(u>=) operator-bench                    cr ."   1- u< ..." ['] 1(u>=) operator-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( 3clshift-bench 8*-bench )                                     need bench{ need }bench. need clshift                           : 3clshift-bench ( u -- )                                         bench{  0 ?do  1 3 clshift drop   loop  }bench. ;             : 8*-bench ( u -- )                                               bench{  0 ?do  1 8 * drop   loop  }bench. ;                   : run ( u -- )                                                    dup cr ." 3 clshift ..." 3clshift-bench                             cr ." 8 * ........." 8*-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( search-bench )                                                need bench{ need }bench. need alias need alias!                 0 $FFFF 2constant haystack                                      s" Need" $FF00 1- place 'l' $FF04 c! 'e' $FF05 c!               $FF00 6 2constant needle                                        defer do-search                                                 : search-bench ( u xt -- )                                        ['] do-search defer!                                            bench{  0 ?do  haystack needle do-search drop 2drop   loop      }bench. ;                                                     : run ( u -- )                                                    dup cr ." DZX-Forth .........." ['] search search-bench         dup cr ." Z88 CamelForth 1 ..." ['] search881 search-bench          cr ." Z88 CamelForth 2 ..." ['] search88 search-bench ;                                                                                                                                   ( <-bench )                                                     need bench{ need j                                              defer (<)                                                       variable times                                                  : <-bench ( u xt -- )                                             ['] (<) defer!  times !                                         bench{                                                            times @ 0 ?do  times @ 0 ?do  i j                               (<) drop  loop  loop                                          }bench. ;                                                     : run ( u -- )                                                        cr ." Implementation of <"                                  dup cr ."   DZX-Forth .........." ['] < <-bench                     cr ."   Z88 CamelForth ....." ['] <88 <-bench ;                                                                                                                                           ( =-bench )                                                     need bench{                                                     defer (=)                                                       variable times                                                  : =-bench ( u xt -- )                                             ['] (=) defer!  times !                                         bench{                                                            times @ 0 ?do  2 2 (=) 1 0 (=) 2drop  loop                    }bench. ;                                                     : run ( u -- )                                                        cr ." Implementation of ="                                  dup cr ."   DZX-Forth .........." ['] = =-bench                 dup cr ."   Z88 CamelForth 1...." ['] =881 =-bench                  cr ."   Z88 CamelForth 2...." ['] =882 =-bench ;                                                                                                                                          ( min-bench )                                                   need bench{ need j                                              defer (<)                                                       variable times                                                  : <-bench ( u xt -- )                                             ['] (<) defer!  times !                                         bench{                                                            times @ 0 ?do  times @ 0 ?do  i j                               (<) drop  loop  loop                                          }bench. ;                                                     : run ( u -- )                                                        cr ." Implementation of <"                                  dup cr ."   DZX-Forth .........." ['] < <-bench                     cr ."   Z88 CamelForth ....." ['] <88 <-bench ;                                                                                                                                           ( ?throw-bench )                                                need >body need bench{ need }bench.                             : ?throw0 ( f n -- ) swap if  throw  else  drop  then ;         : ?throw1 ( f n -- )                                              swap ?branch [ ' throw >body , ] drop ;                       : ?throw2 ( f n -- ) swap 0<> and throw ;                       : ?throw3 ( f n -- ) and throw ;                                : ?throw4 ( f n -- ) swap if  throw  then  drop ;               : run ( u -- )                                                    cr ." Versions"                                                 dup cr ." 0: " bench{ 0 ?do  0 0 ?throw0  loop }bench.          dup cr ." 1: " bench{ 0 ?do  0 0 ?throw1  loop }bench.          dup cr ." 2: " bench{ 0 ?do  0 0 ?throw2  loop }bench.          dup cr ." 3: " bench{ 0 ?do  0 0 ?throw3  loop }bench.              cr ." 4: " bench{ 0 ?do  0 0 ?throw4  loop }bench. ;                                                                      ( set-pixel-bench )                                             need bench{ need }bench need bench.                             need slow-gxy>scra_ need fast-gxy>scra_ need set-pixel          need j                                                          : set-pixel-bench ( -- d )                                        bench{                                                            192 0 ?do  256 0 ?do  i j set-pixel  loop  loop               }bench ;                                                      : mode ( xt -- ) ['] gxy>scra_ defer! ;                         : slow ( -- ) ['] slow-gxy>scra_ mode ;                         : fast ( -- ) ['] fast-gxy>scra_ mode ;                         : run ( -- )                                                      cls fast set-pixel-bench cls slow set-pixel-bench cls           ." Results of set-pixel in frames:" cr                          ." slow-gxy>scra_:" bench. cr                                   ." fast-gxy>scra_:" bench. cr ;                               ( pixels-bench )                                                need bench{ need }bench need bench.                             need slow-pixels need fast-pixels                               : garbage ( -- ) 0 16384 6144 move ;                            : pixels-bench ( -- d )                                           cls garbage bench{ pixels }bench rot drop ;                   : mode ( xt -- ) ['] pixels defer! ;                            : slow ( -- ) ['] slow-pixels mode ;                            : fast ( -- ) ['] fast-pixels mode ;                            : run ( -- )                                                      fast pixels-bench slow pixels-bench cls                         ." Results of pixels in frames:" cr                             ." slow-pixels:" bench. cr                                      ." fast-pixels:" bench. cr ;                                                                                                                                                                  ( all-benchmarks )                                              need byte-magazine-benchmark                                    need interface-age-benchmark                                    need vector-loop-benchmark                                      : all-benchmarks ( n -- )                                         dup byte-magazine-benchmark                                         interface-age-benchmark                                         vector-loop-benchmark ;                                     cr                                                              .( To run all main benchmarks) cr                               .( type:) cr                                                    .(   n all-benchmarks) cr                                       .( where _n_ is the number of) cr                               .( iterations done by) cr                                       .( 'byte-magazine-benchmark' and) cr                            .( and 'interface-age-benchmark'.) cr                         ( do-prime )                                                    only forth definitions decimal  need do                         8190 constant size  variable flags  size allot                  : do-prime ( -- )                                                 flags size 1 fill                                               0 size 0                                                        do flags i + c@                                                    if i dup + 3 + dup i +                                               begin   dup size <                                              while   0 over flags + c! over +                                repeat  drop drop 1+                                       then                                                         loop  .  ." primes " ;                                                                                                                                                                                                                                        ( byte-magazine-benchmark )                                     need bench{ need do                                             8190 constant size  variable bflags size allot                  : c<- ( a b -- ) swap c! ;                                      : do-prime ( -- )                                                 bflags size 1 fill  0                                           size 0 do   bflags i + c@ if                                                  i 2* 3 + dup i + bflags +                                       begin   dup size bflags +  u<                                   while   dup 0 c<- over +                                        repeat  drop drop 1+                                          then                                                loop                                                            drop  \ XXX NEW                                                 ;  -->                                                                                                                        ( byte-magazine-benchmark )                                     : byte-magazine-benchmark ( n -- )                                cr ." BYTE Magazine Benchmark:" cr                              dup u. ." iterations..." cr                                     bench{ 0 ?do  do-prime  loop }bench. ;                          cr                                                              .( To run the BYTE Magazine) cr                                 .( benchmark type:) cr                                          .(   n byte-magazine-benchmark) cr                              .( where _n_ is the number of) cr                               .( iterations. The original code) cr                            .( used 1000 iterations.) cr                                                                                                                                                                                                                                                                                                  ( case-benchs )                                                 need bench{                                                     : .used ( u -- ) unused - cr u. ." B used " ;                   32767 constant iterations                                       defer (case-bench) ( -- )                                       : case-bench ( n xt -- )                                          cr ." ..."  ['] (case-bench) defer!                             bench{ iterations 0 ?do  i %11 and (case-bench)  loop           }bench. ;                                                     cr .( default)  unused need case .used  unused                  : case-example ( n -- )                                           case  0 of  noop  endof  1 of  noop  endof  2 of  noop  endof   noop endcase ;                                                .used .( by its example)  ' case-example case-bench  -->                                                                                                                                        ( case-benchs )                                                 cr .( eForth)  unused need eforth-case .used  unused            : case-example ( n -- )                                           case  0 of  noop  endof  1 of  noop  endof  2 of  noop  endof   noop endcase ;                                                .used .( by its example)  ' case-example case-bench             cr .( Forth-94 docs)  unused need eforth-case .used  unused     : case-example ( n -- )                                           case  0 of  noop  endof  1 of  noop  endof  2 of  noop  endof   noop endcase ;                                                .used .( by its example)  ' case-example case-bench             cr .( Abersoft Forth) unused need eforth-case .used  unused     : case-example ( n -- )                                           case  0 of  noop  endof  1 of  noop  endof  2 of  noop  endof   noop endcase ;                                                .used .( by its example)  ' case-example case-bench -->         ( case-benchs )                                                 cr .( positional-case:)                                         unused need positional-case: .used  unused                      positional-case:  positional-case:-example ( n -- )               noop  noop  noop  noop ;                                      .used .( by its example)  ' positional-case:-example case-bench cr .( options[)                                                 unused need options[ .used  unused                              : options[-example ( n -- )                                       options[                                                          0 option noop  1 option noop  2 option noop                       default-option noop                                         ]options ;                                                    .used .( by its example)  ' options[-example case-bench  -->                                                                                                                                    ( case-benchs )                                                 cr .( cases:)                                                   unused need cases: .used  unused                                cases: cases:-example ( n -- )                                    0 case> noop  1 case> noop  2 case> noop  other> noop         .used .( by its example)  ' cases:-example case-bench           cr .( baden-case)                                               unused need baden-case .used  unused                            : baden-case-example ( n -- )                                     case 0 = of  noop  endof                                        case 1 = of  noop  endof                                        case 2 = of  noop  endof                                                 othercase noop ;                                     .used .( by its example)  ' baden-case-example case-bench       -->                                                                                                                             ( case-benchs )                                                 cr .( baden-case-like)                                          unused .used  unused                                            : baden-case-like-example ( n -- )                                dup 0 = if drop  noop  exit then                                dup 1 = if drop  noop  exit then                                    2 = if       noop  exit then                                noop ;                                                        .used .( by its example)  ' baden-case-like-example case-bench  cr .( vannorman-switch)                                         unused need [switch .used  unused                               [switch vannorman-switch-example drop                             0 runs noop  1 runs noop  2 runs noop                         switch]                                                         .used .( by its example)  ' vannorman-switch-example case-bench                                                                 ( do-bench )                                                    need bench{                                                     32767 0 2constant range                                         : forth-83-do ( -- ) bench{  range do83  loop83  }bench. ;      : forth-79-do ( -- ) bench{  range ?do  loop  }bench. ;         : forth-83-i ( -- )                                               bench{  range do83  i83 drop  loop83  }bench. ;               : forth-79-i ( -- )                                               bench{  range ?do  i drop  loop  }bench. ;                    : forth-83-+loop ( -- )                                           bench{  range do83  2 +loop83  }bench. ;                      : forth-79-+loop ( -- ) bench{  range ?do  2 +loop  }bench. ;   : do-bench ( -- ) forth-83-do forth-79-do                                           forth-83-i forth-79-i                                           forth-83-+loop forth-79-+loop ;                                                                             ( exec-bench )                                                  need bench{                                                     : 7border ( -- ) 7 border ;  : 2border ( -- ) 2 border ;        ' 7border ,  here  ' 2border ,  constant execution-table        : do-table ( f -- ) cells execution-table + perform ;           : do-cond-else ( f -- ) if  7 border  else  2 border  then ;    : do-cond-exit ( f -- ) if  7 border exit  then  2 border ;     : exec-bench ( n -- )                                             dup  cr ." Conditional structure with else:" cr bench{  0 ?do             true do-cond-else false do-cond-else                          loop  }bench.                                           dup  cr ." Conditional structure with exit:" cr bench{  0 ?do             true do-cond-exit false do-cond-exit                          loop  }bench.                                                cr ." Execution table:" cr bench{  0 ?do                             true do-table false do-table  loop  }bench. cr ;    ( interface-age-benchmark )                                     need bench{ need 2/                                             : (interface-age-benchmark) ( n -- )                              dup 2/ 1+ swap cr                                               1 ?do                                                             dup i 1 rot 2 do                                                  drop dup 0 i um/mod dup                                         0=  if  drop drop 1 leave  then                                 1 = if    drop 1                                                    else  dup 0= if  drop 0 leave  then                                   0< 0= if  1  then                                         then                                                      loop                                                            2drop  \ XXX NEW                                              loop  drop ; -->                                                                                                              ( interface-age-benchmark )                                     : interface-age-benchmark ( n -- )                                cr ." Interface Age Benchmark:" cr                              dup u. ." iterations..." cr                                     bench{ (interface-age-benchmark) }bench. ;                      cr                                                              .( To run the interface age) cr                                 .( benchmark type:) cr                                          .(   n interface-age-benchmark  ) cr                            .( where _n_ is the number of) cr                               .( iterations. The original code) cr                            .( used 5000 iterations.) cr                                                                                                                                                                                                                                                                                                  ( interface-age-benchmark )                                     : bench ( -- )                                                    dup 2 / 1+ swap ." Starting " cr                                1 do dup i 1 rot                                                  2 do drop dup i /mod                                              dup 0= if  drop drop 1 leave                                    else  1 = if drop 1                                                   else  dup 0 > if  drop 1                                              else  0= if  0 leave  then                                      then                                                      then                                                      then                                                          loop                                                            if  4 .r  else  drop  then                                    loop  drop cr ." Finished " ;                                                                                                 ( rnd-bench )                                                   need bits need u% need cset                                     $FFFF constant #sampled                                         8 constant /byte  \ bits                                        #sampled /byte / constant /sample                               create sample  /sample allot                                    : -sample ( -- ) sample /sample erase ;                         : sampled ( -- u ) sample /sample bits ;                        : remember ( u -- ) /byte /mod sample + cset ;                  : sampled%. ( u -- ) #sampled u% 0.r ." %" ;                    : .sampled ( u -- ) dup u. ." (" sampled%. ." )" ;              : report ( ca len -- ) type sampled .sampled cr ;               : rnd-bench ( ca len xt -- )                                      -sample                                                         #sampled 0 ?do  dup execute remember  loop  drop                report ;                                                      ( rng-pix-bench )                                               need set-pixel need bench{ need pixels need u% need 3dup        need 2rdrop                                                     256 192 * constant #pixels                                      defer rng ( n -- 0..n-1 )                                       : pixels%. ( u -- ) #pixels u% 0.r ." %" ;                      : .pixels ( u -- ) dup u. ." pixels (" pixels%. ." )" ;         : .title ( ca len -- ) ." Code: " type ;                        variable cycles                                                 defer .cycles ( -- )                                            : (.cycles) ( -- )                                                cycles ?  s" cycles" cycles @ 1 = + type ;                    : .time ( d -- ) bench. ." per cycle" cr ;                      : .result ( ca len d -- )                                         2>r pixels >r  .title cr  r> .pixels cr                         2r> .time .cycles ;  -->                                      ( rng-pix-bench )                                               defer random-coords ( -- gx gy )                                : (random-coords) ( -- gx gy ) 256 rng 192 rng ;                : fill-screen ( -- )                                              #pixels 0 ?do  random-coords set-pixel  loop ;                : signal ( -- ) cycles @ %111 and border ;                      : (rnd-pix-bench) ( -- d )                                        1 cycles +!  signal  bench{ fill-screen }bench ;              : wait ( -- ) key drop ;                                        : finish ( ca len d -- ) 0 border  .result  wait ;              : init ( xt1 xt2 xt3 -- )                                         ['] random-coords defer!  ['] .cycles defer!  ['] rng defer!    page  -1 cycles ! ;                                           defer finish? ( i*x -- j*x f )                                  : new-pixels? ( n1 -- n2 f ) pixels tuck = ;                    ' new-pixels? ' finish? defer!  -->                             ( rng-pix-bench )                                               defer rng-pix-bench ( ca len xt -- )                            : (rnd-pix-bench2) ( ca len -- )                                  0 begin   (rnd-pix-bench) 2>r                                             finish? dup 0= if  2rdrop  then                       until     drop 2r> finish ;                                   : rng-pix-bench2 ( ca len xt -- )                                 ['] (.cycles) ['] (random-coords) init                          (rnd-pix-bench2) ;                                            ' rng-pix-bench2 ' rng-pix-bench defer!                         : (.cycle) ( -- ) ." First cycle only" ;                        : (rnd-pix-bench1) ( ca len -- )                                  (rnd-pix-bench) .result wait ;                                : rng-pix-bench1 ( ca len xt -- )                                 ['] (.cycle) ['] (random-coords) init                           (rnd-pix-bench1) ;  -->                                       ( rng-pix-bench )                                               : crnd-coords ( -- gx gy ) rng rng 192 min ;                    : crnd-pix-bench2 ( ca len xt -- )                                ['] (.cycles) ['] crnd-coords init                              (rnd-pix-bench2) ;                                            : crnd-pix-bench1 ( ca len xt -- )                                ['] (.cycle) ['] crnd-coords init                               (rnd-pix-bench1) ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( 16-bit-rng-pix-benchs )                                       need rng-pix-bench need +thru  2 21 +thru                       ace-rng-pix-bench                                               cgm-5E9B-rng-pix-bench cgm-61BF-rng-pix-bench                   cgm-62DC-rng-pix-bench cgm-6363-rng-pix-bench                   cgm-6594-rng-pix-bench cgm-65E8-rng-pix-bench                   dx-rng-pix-bench gf-rng-pix-bench                               jer-rng-pix-bench jml-rng-pix-bench                             lb-rng-pix-bench lina-rng-pix-bench                             mb-rng-pix-bench                                                sf83-rng-pix-bench tt-rng-pix-bench                             vf-rng-pix-bench z88-rng-pix-bench                              zh-rng-pix-bench                                                -->                                                                                                                                                                                             ( 16-bit-rng-pix-benchs )                                       ' rng-pix-bench1 ' rng-pix-bench defer!                         cgm-5E9B-rng-pix-bench cgm-61BF-rng-pix-bench                   cgm-62DC-rng-pix-bench cgm-6363-rng-pix-bench                   cgm-6594-rng-pix-bench cgm-65E8-rng-pix-bench                   dx-rng-pix-bench  vf-rng-pix-bench                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( ace-random )                                                  need os-seed                                                    : ace-rnd ( -- u )                                                os-seed @ 75 um* 75. d+ 2dup u< - - 1- dup os-seed ! ;        : ace-random ( n -- 0..n-1 ) ace-rnd um* nip ;                  need rng-pix-bench                                              : ace-rng-pix-bench ( -- )                                        os-seed off  s" Jupiter ACE manual"                             ['] ace-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( cgm-5E9B-random )                                             2variable rloc  $111 rloc !  \ seed with nonzero                : cgm-5E9B-rnd ( -- u )                                           rloc 2@ $5E9B um* rot 0 d+ over rloc 2! ;                     : cgm-5E9B-random ( n -- 0..n-1 ) cgm-5E9B-rnd um* nip ;        need rng-pix-bench                                              : cgm-5E9B-rng-pix-bench ( -- )                                   s" C. G. Montgomery $5E9B"                                      ['] cgm-5E9B-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( cgm-61BF-random )                                             2variable rloc  $111 rloc !  \ seed with nonzero                : cgm-61BF-rnd ( -- u )                                           rloc 2@ $61BF um* rot 0 d+ over rloc 2! ;                     : cgm-61BF-random ( n -- 0..n-1 ) cgm-61BF-rnd um* nip ;        need rng-pix-bench                                              : cgm-61BF-rng-pix-bench ( -- )                                   s" C. G. Montgomery $61BF"                                      ['] cgm-61BF-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( cgm-62DC-random )                                             2variable rloc  $111 rloc !  \ seed with nonzero                : cgm-62DC-rnd ( -- u )                                           rloc 2@ $62DC um* rot 0 d+ over rloc 2! ;                     : cgm-62DC-random ( n -- 0..n-1 ) cgm-62DC-rnd um* nip ;        need rng-pix-bench                                              : cgm-62DC-rng-pix-bench ( -- )                                   s" C. G. Montgomery $62DC"                                      ['] cgm-62DC-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( cgm-6363-random )                                             2variable rloc  $111 rloc !  \ seed with nonzero                : cgm-6363-rnd ( -- u )                                           rloc 2@ $6363 um* rot 0 d+ over rloc 2! ;                     : cgm-6363-random ( n -- 0..n-1 ) cgm-6363-rnd um* nip ;        need rng-pix-bench                                              : cgm-6363-rng-pix-bench ( -- )                                   s" C. G. Montgomery $6363"                                      ['] cgm-6363-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( cgm-6594-random )                                             2variable rloc  $111 rloc !  \ seed with nonzero                : cgm-6594-rnd ( -- u )                                           rloc 2@ $6594 um* rot 0 d+ over rloc 2! ;                     : cgm-6594-random ( n -- 0..n-1 ) cgm-6594-rnd um* nip ;        need rng-pix-bench                                              : cgm-6594-rng-pix-bench ( -- )                                   s" C. G. Montgomery $6594"                                      ['] cgm-6594-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( cgm-65E8-random )                                             2variable rloc  $111 rloc !  \ seed with nonzero                : cgm-65E8-rnd ( -- u )                                           rloc 2@ $65E8 um* rot 0 d+ over rloc 2! ;                     : cgm-65E8-random ( n -- 0..n-1 ) cgm-65E8-rnd um* nip ;        need rng-pix-bench                                              : cgm-65E8-rng-pix-bench ( -- )                                   s" C. G. Montgomery $65E8"                                      ['] cgm-65E8-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( dx-random )                                                   2variable dx-seed  1. dx-seed 2!                                need d*                                                         : dx-rnd ( -- u )                                                 dx-seed 2@ $15A4E35. d* 1. d+ tuck dx-seed 2! ;               : dx-random ( u -- 0..u-1 ) dx-rnd um* nip ;                    need rng-pix-bench                                              : dx-rng-pix-bench ( -- )                                         s" DX-Forth" ['] dx-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( gf-random )                                                   need os-seed need ud*                                           : gf-rnd ( -- n )                                                 272958469. os-seed @ ud* d>s 1+ dup os-seed ! ;               : gf-random ( n -- 0..n-1 ) gf-rnd um* nip ;                    need rng-pix-bench                                              : gf-rng-pix-bench ( -- )                                         os-seed off  s" Gforth"                                         ['] gf-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( jer-random )                                                  need os-seed                                                    : jer-rnd ( -- n )                                                os-seed @ 259 * 3 + 32767 and dup os-seed ! ;                 : jer-random ( n1 -- n2 )                                         jer-rnd 32767 */ ;                                            need rng-pix-bench                                              : jer-rng-pix-bench ( -- )                                        os-seed off  s" J. E. Rickenbacker"                             ['] jer-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                ( jml-random )                                                  need assembler need os-seed                                     code jml-rnd ( -- u )                                             os-seed fthl, h push,                                           h addp, h addp, h addp, h addp, h addp, h addp,                 d pop, d addp, 0029 d ldp#, d addp,                             os-seed sthl,                                                   jppushhl,                                                       end-code                                                      : jml-random ( n -- 0..n-1 ) jml-rnd um* nip ;                  need rng-pix-bench                                              : jml-rng-pix-bench ( -- )                                        os-seed off  s" J. M. Lazo"                                     ['] jml-random rng-pix-bench ;                                                                                                                                                                ( lb-random )                                                   need os-seed                                                    : lb-rnd ( -- u ) os-seed @ 31421 * 6927 + dup os-seed ! ;      : lb-random ( n -- 0..n-1 ) lb-rnd um* nip ;                    need rng-pix-bench                                              : lb-rng-pix-bench ( -- )                                         os-seed off  s" Leo Brodie"                                     ['] lb-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( lina-random )                                                 need os-seed                                                    : lina-rnd ( -- n )                                               os-seed @ 107465 * 234567 + dup os-seed ! ;                   : lina-random ( n -- 0..n-1 ) lina-rnd um* nip ;                need rng-pix-bench                                              : lina-rng-pix-bench ( -- )                                       os-seed off  s" lina"                                           ['] lina-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ( mb-random )                                                   need assembler need os-seed                                     code mb-rnd ( -- u )                                              os-seed d ftp,                                                  d a ld, e h ld, #253 l ld#,                                     a or, d sbcp,                                                   0 sbc#, d sbcp,                                                 0 d ld#, d sbc, a e ld, d sbcp,                                 c? rif  h incp,  rthen                                          os-seed sthl, jppushhl, end-code                              : mb-random ( n -- 0..n-1 ) mb-rnd um* nip ;                    need rng-pix-bench                                              : mb-rng-pix-bench ( -- )                                         os-seed off  s" Milos Bazelides"                                ['] mb-random rng-pix-bench ;                                                                                                 ( mm-random )                                                   need cell/ need frames@                                         variable seed1  variable seed2                                  : randomize ( -- ) frames@ seed1 ! seed2 ! ;                    : 0seed ( -- ) seed1 off seed2 off ;  0seed                     : mm-random ( n1 --- n2 )                                         seed1 @ 123 * 234 + seed2 @ 234 * 123 +                         2dup + seed2 ! 2dup xor seed1 !                                 + swap cells mod cell/ ;                                      need rng-pix-bench                                              : mm-rng-pix-bench ( -- )                                         s" IsForth" ['] mm-random rng-pix-bench ;                                                                                                                                                                                                                                                                                     ( sf83-random )                                                 need os-seed  3 os-seed !                                       : sf83-random ( n -- 0..n-1 )                                     os-seed @ 743 * 43 + dup os-seed ! um* swap drop ;            need rng-pix-bench                                              : sf83-rng-pix-bench ( -- )                                       s" Spectrum Forth-83"                                           ['] sf83-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ( tt-random )                                                   need os-seed                                                    : tt-random ( n -- 0..n-1 )                                         os-seed @ 13 * $7FFF and                                        dup os-seed !  swap mod ;                                   need rng-pix-bench                                              : tt-rng-pix-bench ( -- )                                         os-seed on  s" Tetris for terminals"                            ['] tt-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( vf-random )                                                   need os-frames                                                  : vf-random ( n -- 0..n-1 )                                       1+ 8195 os-frames @ um* 1. d+                                   16383 um/mod drop                                               swap mod ;                                                    need rng-pix-bench                                              : vf-rng-pix-bench ( -- )                                         s" vForth" ['] vf-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ( z88-random )                                                  need ud* need os-seed need 2rdrop                               : z88-random ( n -- 0..n-1 )                                      1103515245. \ 20077 16838                                       os-seed @ ud* 12345. d+ over os-seed !                          rot ud/mod 2drop ;                                            need rng-pix-bench                                              : z88-rng-pix-bench ( -- )                                        os-seed off  s" Z88 CamelForth"                                 ['] z88-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                ( zh-random )                                                   need assembler need os-seed                                     code zh-rnd ( -- u )                                              os-seed fthl, h d ldp,                                          h addp, d addp, h addp, d addp, h addp,                         d addp, h addp, h addp, h addp, h addp, d addp,                 h inc, h incp, os-seed sthl, jppushhl, end-code               : zh-random ( n -- 0..n-1 ) zh-rnd um* nip ;                    need rng-pix-bench                                              : zh-rng-pix-bench ( -- )                                         os-seed off  s" Z80 Heaven"                                     ['] zh-random rng-pix-bench ;                                                                                                                                                                                                                                                                                                 ( random-byte )                                                 code random-byte ( -- b )                                         ED c, 5F c,     \ ld a,r                                        C3 c, pusha ,   \ jp pusha                                      end-code                                                      need bench{                                                     : random-byte-bench ( -- )                                        ['] random-byte ['] rng defer!  cls  bench{ pixels              ?do  rng rng 192 min set-pixel  loop  }bench.                   ." Z80 R register" cr key drop ;                                                                                                                                                                                                                                                                                                                                                                                                                              ( lcm-random )                                                  need d* need du/mod need 2nip                                   2variable 2seed                                                 2147483647. 2constant max32                                     : lcm-rnd ( -- d )                                                2seed 2@ 16807. d*                                              max32 du/mod  2nip                                              2dup 2seed 2! ;                                               : lcm-random ( n -- 0..n-1 ) lcm-rnd d>s um* nip ;              need rng-pix-bench                                              : lcm-rng-pix-bench ( -- )                                        s" LCM" ['] lcm-random rng-pix-bench ;                                                                                                                                                                                                                                                                                        ( 8-bit-rng-pix-benchs )                                        need rng-pix-bench need +thru  1 8 +thru                        ' crnd-pix-bench2 ' rng-pix-bench defer!                          jw-rng-pix-bench                                                zh-rng-pix-bench                                                libzx-rng-pix-bench                                             libzx-rng-pix-bench-opt2                                        libzx-rng-pix-bench-opt1                                        libzx-rng-pix-bench-opt3  \ XXX FIXME -- crash after!         ' crnd-pix-bench1 ' rng-pix-bench defer!                          jw-rng-pix-bench                                                libzx-rng-pix-bench  \ XXX FIXME -- crash after!                libzx-rng-pix-bench-opt1                                        libzx-rng-pix-bench-opt2                                        libzx-rng-pix-bench-opt3                                                                                                      ( jw-crnd )                                                     need assembler need os-seed                                     code jw-crnd ( -- b )                                             os-seed fthl, ED c, 5F c, a d ld, m e ld,                       d addp, l add, h xor, os-seed sthl, pusha jp, end-code        need rng-pix-bench                                              : jw-rng-pix-bench ( -- )                                         os-seed off  s" Joe Wingbermuehle"                              ['] jw-crnd rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ( mb1-crnd )                                                    need assembler need os-seed                                     code mb1-crnd ( -- b )                                            os-seed fta, a d ld, a add, a add, d add,                       a inc, os-seed sta, pusha jp, end-code                        : mb1-crandom ( n1 -- n2 ) mb1-crnd um* nip ;                   need rng-pix-bench                                              : mb1-rng-pix-bench ( -- )                                        os-seed off  s" Milos Bazelides 1 (8 bit)"                      ['] mb1-crnd rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                  ( mb2-crnd )                                                    need assembler need os-seed                                     code mb2-crnd ( -- b )                                            os-seed fta, a d ld, a add, a add, d add,                       07 add#, os-seed sta, pusha jp, end-code                      : mb2-crandom ( n1 -- n2 ) mb2-crnd um* nip ;                   need rng-pix-bench                                              : mb2-rng-pix-bench ( -- )                                        os-seed off  s" Milos Bazelides 2 (8 bit)"                      ['] mb2-crnd rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                                                                                                                  ( zh-crnd )                                                     need assembler need os-seed                                     code zh-crnd ( -- b )                                             os-seed fta, a e ld,                                            a add, e add, a add, a add, e add, #83 add#,                    os-seed sta,                                                    pusha jp,                                                       end-code                                                      need rng-pix-bench                                              : zh-rng-pix-bench ( -- )                                         s" Z80 Heaven (8 bit)" ['] zh-crnd rng-pix-bench ;                                                                                                                                                                                                                                                                                                                                            ( libzx-crnd-opt3 )                                             need assembler need os-seed need rng-pix-bench                  variable rom-pointer  rom-pointer off  os-seed off              code libzx-crnd-opt3 ( -- b )                                     b push, af push,                                                rom-pointer h ftp, h incp,                                      h a ld, %00111111 and, a h ld, h rom-pointer stp,               b pop, c rlc, b rlc, os-seed fta,                               47 add#, b add, c add, d add, e add, h add, l add,              rom-pointer h ldp#, m add,                                      os-seed sta, b pop, pusha jp, end-code                        : libzx-rng-pix-bench-opt3 ( -- )                                 rom-pointer off  os-seed off  s" libzx opt3 (8 bit)"            ['] libzx-crnd-opt3 rng-pix-bench ;                                                                                                                                                           ( libzx-crnd-opt2 )                                             need assembler need os-seed need rng-pix-bench                  variable rom-pointer  rom-pointer off  os-seed off              code libzx-crnd-opt2 ( -- b )                                     b push, af push,                                                rom-pointer h ftp, h incp,                                      h a ld, %00111111 and, a h ld, h rom-pointer stp,               b pop, c rlc, b rlc, os-seed fta,                               47 add#, b add, c add, d add, e add, h add, l add,              rom-pointer h ldp#, m add,                                      os-seed sta,                                                    b pop, pusha jp, end-code                                     : libzx-rng-pix-bench-opt2 ( -- )                                 rom-pointer off  os-seed off  s" libzx opt2 (8 bit)"            ['] libzx-crnd-opt2 rng-pix-bench ;                                                                                           ( libzx-crnd-opt1 )                                             need assembler need os-seed need rng-pix-bench                  variable rom-pointer  3 rom-pointer !  33 os-seed c!            code libzx-crnd-opt1 ( -- b )                                     b push, af push,                                                rom-pointer b ftp, 3 h ldp#, b addp,                            h a ld, %00111111 and, a h ld, h rom-pointer stp,               b pop, c rlc, b rlc, os-seed fta,                               47 add#, b add, c add, d add, e add, h add, l add,              rom-pointer h ldp#, m add,                                      os-seed sta,                                                    b pop, pusha jp, end-code                                     : libzx-rng-pix-bench-opt1 ( -- )                                 3 rom-pointer !  33 os-seed c!  s" libzx opt1 (8 bit)"          ['] libzx-crnd-opt1 rng-pix-bench ;                                                                                           ( libzx-crnd )                                                  need assembler need os-seed need rng-pix-bench                  variable rom-pointer  3 rom-pointer !  33 os-seed c!            code libzx-crnd ( -- b )                                          b push, af push,                                                rom-pointer h ldp#,                                             m c ld, h incp, m b ld, 3 h ldp#, b addp,                       h a ld, %00111111 and, a h ld, h rom-pointer stp,               b pop, c rlc, b rlc, os-seed fta,                               47 add#, b add, c add, d add, e add, h add, l add,              rom-pointer h ldp#, m add,                                      os-seed h ldp#, m a ld,                                         b pop, 0 h ld#, a l ld, jppushhl, end-code                    : libzx-rng-pix-bench ( -- )                                      3 rom-pointer !  33 os-seed c!                                  s" libzx (8 bit)" ['] libzx-crnd rng-pix-bench ;              ( vector-loop-benchmark )                                       need bench{                                                     1000 constant vsize  \ vector size                              : vector ( n -- )                                                 create  cells allot                                             does> ( index -- address ) ( index pfa ) swap cells + ;       vsize vector vec1  vsize vector vec2  vsize vector vec3         : vecload ( -- ) \ put some stuff into the vectors                0 begin                                                            dup vec1 dup !               \ vec1 gets its own address        dup vec2 dup negate swap !   \ vec2 gets negated address        1+ dup vsize =                                               until  drop ;                                                 : loop0 ( -- ) \ null loop                                        0 begin  1+ dup vsize =  until  drop ;  -->                                                                                   ( vector-loop-benchmark )                                       : loop1 ( -- ) \ vector add                                       0 begin                                                            dup vec1 @ over vec2 @ + over vec3 !                            1+ dup vsize =                                               until  drop ;                                                 : loop2 ( -- ) \ vector multiply                                  0 begin                                                            dup vec1 @ over vec2 @ * over vec3 !                            1+ dup vsize =                                               until  drop ;                                                 : loop3 ( -- ) \ vector divide                                    0 begin                                                           dup vec1 @ over vec2 @ / over vec3 !                            1+ dup vsize =                                                until  drop ;  -->                                            ( vector-loop-benchmark )                                       : loop4 ( -- ) \ vector scale                                     0 begin                                                            dup vec1 @ 10000 10000 */ over vec2 !  1+ dup vsize =        until  drop ;                                                 1000 constant reps  \ repetitions                               : bench0 ( -- ) \ benchmark loop0                                 bench{ 0 begin  loop0 1+ dup reps =  until  drop }bench.        ." Vector No-Op" cr ;                                         : bench1 ( -- ) \ benchmark loop1                                 bench{ 0 begin  loop1 1+ dup reps =  until  drop }bench.        ." Vector +    " cr ;                                         : bench2 ( -- ) \ benchmark loop2                                 bench{ 0 begin  loop2 1+ dup reps =  until  drop }bench.        ." Vector *    " cr ;                                         -->                                                             ( vector-loop-benchmark )                                       : bench3 ( -- ) \ benchmark loop3                                 bench{ 0 begin  loop3 1+ dup reps =  until  drop }bench.        ." Vector /    " cr ;                                         : bench4 ( -- ) \ benchmark loop4                                 bench{ 0 begin  loop4 1+ dup reps =  until  drop }bench.        ." Vector */   " cr ;                                         : vector-loop-benchmark ( -- )                                    cr ." Vector Loop Benchmark:" cr                                vecload  cr bench0 bench1 bench2 bench3 bench4 ;                cr                                                              .( To run the vector loop) cr                                   .( benchmarks type:) cr                                         .(   vector-loop-benchmarks ) cr                                                                                                                                                              ( sqrt-test )                                                   need baden-sqrt need newton-sqrt need printer                   : run ( -- ) cr ." Printing different results" cr                                  ." Press BREAK to stop" cr cr printer cr                        ." Number baden-sqrt  newton-sqrt" cr                           ." ------ ----------- -----------" cr          32768 0 ?do                                                       i newton-sqrt i baden-sqrt 2dup <>                              if  i 6 .r space 11 .r space 11 .r cr else 2drop then           break-key? if display ." Break." cr leave then                loop display ." End."  ;                                                                                                                                                                                                                                                                                                                                                                      ( menu-test )                                                   need menu need :noname                                          :noname ( -- ) unnest unnest ;                                  :noname ( -- ) 2 border ;                                       :noname ( -- ) 1 border ;                                       :noname ( -- ) 0 border ;                                       create actions> , , , ,                                         here s" EXIT"  s,                                               here s" Red"   s,                                               here s" Blue"  s,                                               here s" Black" s,                                               create texts> , , , ,                                           : menu-pars actions> texts> s" Border" 7 7 14 4 ;               : h ( -- ) home default-colors ;                                menu-pars new-menu                                                                                                              ( orthodraw-test ortholine-test )                               need orthodraw need ortholine need attr! need ms need random    variable delay  300 delay !  variable length  30 length !       2variable center  100 100 center 2!                             : ray ( gx gy n1 n2 xt )                                          >r center 2@ 2swap length @ r> execute delay @ ms ;           : color ( -- b ) 7 random 1+ ;                                  : d-ray ( gx gy n1 n2 ) color attr! ['] orthodraw ray ;         : d-test ( -- ) 0  1 d-ray  1  1 d-ray  1 0 d-ray  1 -1 d-ray                   0 -1 d-ray -1 -1 d-ray -1 0 d-ray -1  1 d-ray ; : l-ray ( gx gy n1 n2 ) ['] ortholine ray ;                     : l-test ( -- ) 0  1 l-ray  1  1 l-ray  1 0 l-ray  1 -1 l-ray                   0 -1 l-ray -1 -1 l-ray -1 0 l-ray -1  1 l-ray ; : run ( -- ) 100 100 center 2! 30 length ! d-test                            130 120 center 2! 50 length ! l-test ;                                                                             ( gigatype-test )                                               need gigatype                                                   : run ( -- )                                                      cls                                                             8 0 ?do                                                           17 0 i 3 * tuck at-xy s" GIGATYPE" i gigatype                                   at-xy ." style "   i .                        loop                                                            key drop home ;                                               run                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( l:-test )                                                     need assembler also assembler need l: previous                  code a-call ( a -- )                                              #3 rl# jr, nop, #3 rl# c? ?jr,                                  #2 call, al#                                                    nop,                                                            #2 l: ret,                                                      #3 l: nop,                                                      #3 jp, al#                                                      #2 rl# jr,                                                      ret,                                                            end-code                                                        cr .( Disassemble at ) ' a-call u. cr .( to see the result)                                                                                                                                                                                                   ( udg-group-test )                                              need udg-group need set-udg                                     here 5 8 * allot set-udg                                        5 1 0 udg-group                                                 ..XXXX.. ..XXXX.. ..XXXX.. ..XXXX.. ..XXXX..                    .XXXXXX. .XXXXXX. .XXXXXX. .XXXXXX. .X.XXXX.                    XXXXXXXX XXXXXXXX XXXXXXXX X.XXXXXX X.XXXXXX                    XXXXXXXX XXXXXXXX X.XXXXXX X.XXXXXX XXXXXXXX                    XXXXXXXX X.XXXXXX X.XXXXXX XXXXXXXX XXXXXXXX                    XX..XXXX XX.XXXXX XXXXXXXX XXXXXXXX XXXXXXXX                    .XXXXXX. .XXXXXX. .XXXXXX. .XXXXXX. .XXXXXX.                    ..XXXX.. ..XXXX.. ..XXXX.. ..XXXX.. ..XXXX..                    : run ( -- ) cr 5 0 ?do i emit-udg loop cr ;                    run                                                                                                                                                                                             ( udg-block-test )                                              need udg-block need set-udg                                     create udg-font 5 8 * allot udg-font set-udg                    5 1 0 udg-block                                                 ....XXXXXXXXXXXXXXXXXXXXXXXXXXX.........                        ...XXXXXXXXXXXXXXXXXXXXXXXXXXX..........                        ..XXXXXXXXXXXXXXXXXXXXXXXXXXX...........                        .XXXXXXXXXXXXXXXXXXXXXXXXXXX............                        XXXXXXXXXXXXXXXXXXXXXXXXXXX.............                        XXXXXXXXXXXXXXXXXXXXXXXXXX..............                        XXXXXXXXXXXXXXXXXXXXXXXXX...............                        ....XXXXXXXXXXXXXXXXXXXXXXXXXXX.........                        : run ( -- ) cr 5 0 ?do i emit-udg loop cr ;                    run                                                                                                                                                                                             ( local-test )                                                  need local                                                      variable tmp  tmp off cr .( original value of tmp = ) tmp ?     : run ( -- ) tmp local                                            1001 tmp ! cr ." temporary value of tmp = " tmp ? cr ;        run                                                             cr .( restored value of tmp = ) tmp ?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( anon-test )                                                   need anon  here anon> ! 5 cells allot                           : run5  ( x[n-1]..x[0] n -- )                                     set-anon cr                                                     [ 0 ] anon ?                   \ print first parameter          123 [ 0 ] anon ! [ 0 ] anon ?  \ print 123                      [ 1 ] anon ?                   \ print second parameter         [ 2 ] anon ?                   \ print third parameter          555 [ 2 ] anon ! [ 2 ] anon ?  \ print 555                      [ 3 ] anon ?                   \ print fourth parameter         [ 4 ] anon ? ;                 \ print fifth parameter        400 300 200 100 000 5 run5                                      here anon> ! 2 cells allot                                      : run2  ( x[n-1]..x[0] n -- )                                     set-anon cr [ 0 ] anon ? [ 1 ] anon ? ;                       2002 1001 2 run2                                                ( arguments-test )                                              need arguments need results need toarg need +toarg need 3dup    : val-test ( length width height -- length' volume surface )      3 arguments   l0 l1 * toarg l5       \ surface                                l5 l2 * toarg l4       \ volume                                 $2000 +toarg l0        \ length+$2000                           l4 toarg l1            \ volume                                 l5 toarg l2            \ surface                  3 results ;                                                   : var-test ( length width height -- length' volume surface )      3 arguments   l0 @ l1 @ * l5 !   \ surface                                    l5 @ l2 @ * l4 !   \ volume                                     $2000 l0 +!        \ length+$2000                               l4 @ l1 !            \ volume                                   l5 @ l2 !            \ surface                    3 results ; -->                                               ( arguments-test )                                              defer test                                                      : .results ( length width height -- )                             ." OUTPUT" cr ."   Surface:" . cr                                             ."   Volume: " . cr                                             ."   Length + 8192: " . cr ;                    : run ( length width height -- )                                  3dup 3dup                                                       cr ." INPUT"  cr ."   Length: " . cr                                             ."   Width:  " . cr                                             ."   Height: " . cr                            ." Value-like arguments:"    cr val-test .results               arg-default-action off  arg-action off                          ." Variable-like arguments:" cr var-test .results ;                                                                                                                                           ( dzx7-test )                                                   need dzx7s need dzx7t need dzx7m need file> need case           create compressed 6912 allot                                    : run ( -- )                                                      page ." Press any key to load the" cr                                ." compressed screen from the" cr                              ." first disk drive. 'Q' to quit." key 'q' = ?exit          1 set-drive throw s" img.zx7"  compressed 0 file> throw         page  begin home                                                        ." Decompress with dzx7[S/T/M]" cr ." or [Q]uit" cr             key lower case                                                    's' of page compressed 16384 dzx7s endof                        't' of page compressed 16384 dzx7t endof                        'm' of page compressed 16384 dzx7m endof                        'q' of quit endof                                             endcase again ; run                                   ( udg-row[-test )                                               need udg-row[ need set-udg                                      create graphic 16 allot  graphic set-udg                          0 udg-row[                                                      000000000010010000000000                                        000000000010010000000000                                        000000000110011000000000                                        001111111111111111111100                                        011111111111111111111110                                        111111111111111111111111                                        111111111111111111111111                                        011111111111111111111110                                        ]udg-row                                                        cr 0 emit-udg 1 emit-udg 2 emit-udg cr                                                                                                                                                        ( bank-test )                                                   $FFFF constant test-addr                                        : b? ( n -- ) bank test-addr c@ . ;                             : (prepare-bank) ( n -- )                                         dup . dup bank banks 1- and test-addr c! ;                    : prepare-bank ( n -- )                                           dup 5 = if drop else (prepare-bank) then ;                    : prepare-banks ( n1 n2 -- )                                      cr ." Preparing banks:" ?do i prepare-bank loop ;             : check-bank ( n -- ) dup . dup bank test-addr c@ =                                   if ." OK" else ." NO" then space ;        : check-banks ( n1 n2 -- )                                        cr ." Checking banks:" ?do i check-bank loop ;                : run ( n1 n2 -- )                                                2dup prepare-banks check-banks default-bank ;                                                                                 ( -do-test )                                                    need do need -do                                                cr .( Results of '-1 +loop' loops:)                             : count-down ( limit start -- ) do i . -1 +loop ;               cr .( '0 0 do' prints 0) 0 0 count-down                         cr .( '4 0 do' prints 0 -1..-32768 32767..4) \ 4 0 count-down   cr .( '0 4 do' prints 4 3 2 1 0:) 0 4 count-down                : ?count-down ( limit start -- ) ?do i . -1 +loop ;             cr .( '0 0 ?do' prints nothing:) 0 0 ?count-down                cr .( '4 0 ?do' prints 0 -1..-32768 32767..4) \ 4 0 ?count-down cr .( '0 4 ?do' prints 4 3 2 1 0:) 0 4 ?count-down              : -count-down ( limit start -- ) -do i . -1 +loop ;             cr .( '0 0 -do' prints nothing:) 0 0 -count-down                cr .( '4 0 -do' prints nothing:) 4 0 -count-down                cr .( '0 4 -do' prints 4 3 2 1:) 0 4 -count-down                                                                                ( .tape )                                                       : .tape ( -- )                                                    cr ." Tape header " tape-header u. cr                              ." Filetype    " tape-filetype c@ . cr                          ." Filename    " tape-filename /tape-filename type cr           ." Length      " tape-length @ u. cr                            ." Start       " tape-start @ u. cr                             .s cr                                                           ." Press any key" key drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ( edit-sound-test )                                             need edit-sound need >body need shoot                           create explosion /sound allot                                   ' shoot >body explosion /sound move                             explosion edit-sound                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( fzx-test )                                                    need fzx-mode need <file                                        create font  2048 allot                                           .( Loading a FZX font...)                                     1 set-drive throw  font 0 s" lett.fzx" <file                    font fzx-font !                                                 : zxtype ( ca len -- ) bounds ?do  i c@ fzx-emit  loop ;        cr .( fzx-emit is ready ) cr                                    ' (fzx-emit)                                                    cr .( Code start:   ) dup u.                                    cr .( Code length:  ) ' fzx-emit swap - u.                      cr                                                                                                                                                                                                                                                                                                                              ( select-test )                                                 : select-test ( n -- )                                            space                                                           select                                                            cond  $00 $1F range                                                   $7F     equal  when  ." Control char "       else         cond  $20 $2F range                                                   $3A $40 range                                                   $5B $60 range                                                   $7B $7E range  when  ." Point "              else         cond  $30 $39 range  when  ." Digit "              else         cond  $41 $5A range  when  ." Upper case letter "  else         cond  $61 $7A range  when  ." Lower case letter "  else         ." Not a character "                                          endselect ;  -->                                                                                                              ( select-test )                                                 cr cr .( Running 'select' test...)                              cr  'a'  .(   ) dup emit  select-test                           cr  ','  .(   ) dup emit  select-test                           cr  '8'  .(   ) dup emit  select-test                           cr  '?'  .(   ) dup emit  select-test                           cr  'K'  .(   ) dup emit  select-test                           cr  0              dup 3 .r  select-test                        cr  127            dup 3 .r  select-test                        cr  128            dup 3 .r  select-test                                                                                                                                                                                                                                                                                                                                                                                                                        ( substitute-test )                                             need substitute need replaces need xt-replaces                  create result 255 chars allot                                   s" saluton"  s" hello"    replaces                              s" bonvenon" s" welcome"  replaces                              : substitute-test ( ca len -- )                                   2dup cr type result 255 substitute cr dup 0< over ?throw        . ." substitutions:" cr type cr ;                             s" Say '%hello%' and '%welcome%'" substitute-test               s" The percentage sign is %%" substitute-test                   : fth  s" Forth" ; ' fth s" lang" xt-replaces                   s" I program in %lang%" substitute-test                         : z80  s" Z80 assembly" ; ' z80 s" lang" xt-replaces            s" I program in %lang%" substitute-test                         s" Say '%hello%' in %lang%" substitute-test                                                                                     ( >name-test )                                                  need far,                                                       variable name0  1000 far,                                       variable name1                                                  defined name0 cr .name                                          defined name1 cr .name                                          ' name0 >name cr .name                                          ' name1 >name dup 0=                                             ?\ .( not found!)  \ or simply hang!                            ?\ .name                                                                                                                                                                                                                                                                                                                                                                                                                                                       ( transient-test )                                                need fyi need transient                                           2023 1700 transient  \ works                                  unused farunused                                                need assembler   cr .( Memory used by the assembler:)               farunused - cr u. .(  headers space)    \ 1777 B                   unused - cr u. .(  data/code space)  \ 1623 B            cr .( Is headers space corrupted?:)                             cr .( This should read "26972": ) 0 far@ dup u.                 26972 = ?\ cr .( BUT IT DOESN'T!)                               cr .( This name:   ") $04 .name .( ")                           cr .( Should read: "forth ")                                    cr .( This name:   ") $0E .name .( ")                           cr .( Should read: "forth-wordlist ") cr                        end-transient  code zx exx, exx, jpnext, end-code               forget-transient                                              ( window-test )                                                 need window need wtype need wcls need ~~ need s+                :noname ( ca len -- )                                            0 ~~y @ 3 + at-xy ." x " wx c@ . ." y " wy c@ .                                   ." free " wfreecolumns . ;                   ' ~~app-info defer!                                             window my-window                                                : txt ( -- ca len )                                               s" En un lugar de La Mancha de cuyo nombre no quiero"           s"  acordarme no ha mucho tiempo que..." s+ ;                 default-colors cls 7 border                                     20  5  8 15 set-window 6 paper 0 ink wcls txt wtype              2  2 22  6 set-window 5 paper 0 ink wcls txt wtype              0 10 10 12 set-window 2 paper 7 ink wcls txt wtype             home default-colors                                                                                                             ( /sconstants-test )                                            need /sconstants                                                0                \ end of strings                                 here ," kvar"  \ string 4                                       here ," tri"   \ string 3                                       here ," du"    \ string 2                                       here ," unu"   \ string 1                                       here ," nul"   \ string 0                                     /sconstants digitname  constant digitnames                      cr .( There are ) digitnames . .( digit names:)                 0 digitname cr type                                             1 digitname cr type                                             2 digitname cr type                                             3 digitname cr type cr                                                                                                                                                                          ( sconstants-test )                                             need sconstants                                                 0                \ end of strings                                 here ," kvar"  \ string 4                                       here ," tri"   \ string 3                                       here ," du"    \ string 2                                       here ," unu"   \ string 1                                       here ," nul"   \ string 0                                     sconstants digitname                                            0 digitname cr type                                             1 digitname cr type                                             2 digitname cr type                                             3 digitname cr type cr                                                                                                                                                                                                                                          ( associative-list-test )                                       need associative-list need items                                need entry: need centry: need 2entry: need sentry:              associative-list stuff                                          1887          stuff entry:  year                                'E'           stuff centry: letter                              s" Saluton"   stuff sentry: hello                               314159.       stuff 2entry: pi                                  cr .( Keys:) cr stuff items cr                                  cr .( Values: ) cr                                              s" year"    stuff item . cr                                     s" letter"  stuff item emit cr                                  s" hello"   stuff item type cr                                  s" pi"      stuff item d. cr                                                                                                                                                                    ( transient-asm-test )                                          only forth definitions                                          need order need wordlist-words need .wordname                   : info ( -- )                                                     cr ." here            =" here u.                                cr ." np              =" np@ u.                                 cr ." latest-wordlist =" latest-wordlist @ u.                   cr ." limit           =" limit @ u.                             cr ." farlimit        =" farlimit @ u.                          cr ." latest          =" latest dup u. .name                    cr ." current-latest  =" current-latest dup u. .name            order                                                           cr ." Continue? (y/n)"                                          begin  key dup 'n' = if  abort  then  'y' = until ;  -->                                                                                                                                      ( transient-asm-test )                                          need transient                                                  cr .( Before transient :)         info  2000 2000 transient     cr .( After transient :)          info need assembler           cr .( Before end-transient :)     info  end-transient           cr .( After end-transient :)      info need n>r                 cr .( Before forget-transient :)  info  forget-transient        cr .( After forget-transient :)   info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ( transient-test )                                              : info ( -- )                                                     cr ." here            =" here u.                                cr ." np              =" np@ u.                                 cr ." latest-wordlist =" latest-wordlist @ u.                   cr ." limit           =" limit @ u.                             cr ." farlimit        =" farlimit @ u.                          cr ." Press any key to continue" key drop ;                   need transient  cr .( Before transient :) info  100 transient   cr .( After transient :) info                                   : transient-code ( -- ) ." bla bla bla bla" ;                   cr .( Before end-transient :) info end-transient                cr .( After end-transient :) info                               : using ( -- ) transient-code ;  cr using  \ works fine         forget-transient  cr .( After forget-transient :) info          cr using  \ works fine                                          ( nest-need-test nnt1 nnt2 nnt3 nnt4 nnt5 nnt6 nnt7 nnt8 nnt9 ) [unneeded] nest-need-test ?\ need nnt1  defer nest-need-test    [unneeded] nnt1 ?\ need nnt2  defer nnt1  exit                  [unneeded] nnt2 ?\ need nnt3  defer nnt2  exit                  [unneeded] nnt3 ?\ need nnt4  defer nnt3  exit                  [unneeded] nnt4 ?\ need nnt5  defer nnt4  exit                  [unneeded] nnt5 ?\ need nnt6  defer nnt5  exit                  [unneeded] nnt6 ?\ need nnt7  defer nnt6  exit                  [unneeded] nnt7 ?\ need nnt8  defer nnt7  exit                  [unneeded] nnt8 ?\ need nnt9  defer nnt8  exit                  [unneeded] nnt9 ?\ defer nnt9                                                                                                                                                                                                                                                                                                                                                                   ( doer-test )                                                   need doer                                                       doer test                                                         cr .( Test 1: ) test                                          make test  cr ." test 2" ;                                        cr .( Test 2: ) test                                          : change    make test ." test 3" ;and  test ;                   change                                                            cr .( Test 3: ) test                                          undo test                                                         cr .( Test 4: ) test                                                                                                                                                                                                                                                                                                                                                                          ( [:-test-1 [:-test-2 [:-test-3 )                               need [: need recurse                                            : [:-test-1 ( -- )                                                cr ." latestxt=" [ latestxt ] literal u.                        [: cr ." Quotation latestxt=" [ latestxt ] literal u. ;]        execute  cr ." The end" ;                                     : [:-test-2 ( -- )                                                cr ." Main"                                                     [: cr ." Enough? (Y/N)" key lower 'y' = ?exit recurse ;]        cr ." About to execute..." execute  cr ." The end" ;          : [:-test-3 ( n -- )                                              cr ." Main:"                                                    [: cr ." Count=" dup . 1- ?dup 0= ?exit recurse ;] execute      cr ." End of quotation" ;                                                                                                                                                                     ( :switch-test )                                                need :switch need <switch need :noname need >body               : one   ( -- ) ." unu " ;                                       : two   ( -- ) ." du " ;                                        : three ( -- ) ." tri " ;                                       : many  ( n -- ) . ." is too much! " ;                          ' many :switch numbers                                            ' one   1 <switch                                               ' two   2 <switch                                               ' three 3 <switch  drop                                       cr 1 numbers 2 numbers 3 numbers 4 numbers                      ' numbers >body  :noname  ." kvar " ; 4 <switch drop            cr 1 numbers 2 numbers 3 numbers 4 numbers                                                                                                                                                                                                                      ( [switch-test )                                                need :switch-test need [switch need [+switch                    need runs need run:                                             [switch sugar-numbers many                                        1 runs one  2 runs two  3 runs three  switch]                 cr 1 sugar-numbers 3 sugar-numbers 4 sugar-numbers              : four  ." kvar " ;                                             [+switch sugar-numbers  4 runs four  switch]                    cr 1 sugar-numbers 3 sugar-numbers 4 sugar-numbers              [+switch sugar-numbers  5 run: ." kvin" ;  switch]              cr 1 sugar-numbers 4 sugar-numbers 5 sugar-numbers                                                                                                                                                                                                                                                                                                                                              ( alias-test synonym-test )                                     need alias need synonym                                         ' literal alias literal-a                                       ' border alias border-a                                         ' if alias if-a                                                 synonym border-s border                                         synonym literal-s literal                                       synonym if-s if                                                 synonym2 border-s2 border                                       synonym2 literal-s2 literal                                     synonym2 if-s2 if                                                                                                                                                                                                                                                                                                                                                                               ( {if-test {do-test )                                           : test2 ( n -- )                                                  {do   dup 5 <   do> ." <5" cr 1+                                |do|  dup 10 <  do> ." <10" cr 1+                               do} drop ;                                                    : test1 ( n1 n2 -- )                                              {if   2dup > if> ." >" cr                                       |if|  2dup < if> ." <" cr                                       if} ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ( options[-test )                                               : o1 ." option 1" ;  : o2 ." option 2" ;  : o3 ." option 3" ;   : test ( c -- )                                                   options[                                                          'a' option o1  'b' option o2  'c' option o3                   ]options  ." end of test" cr ;                                : retest ( -- ) 'a' test ." end of retest" cr ;                 : o0 ." default" ;                                              : testd ( c -- )                                                  options[                                                          'a' option o1  'b' option o2  'c' option o3                     default-option o0                                             ]options ;                                                                                                                                                                                                                                                    ( /-test )                                                      [defined] (/) ?\ defer (/)                                      : ((/-test)) ( dividend divisor -- )                              >r s>d r> (/) swap . . space ;                                : (/-test) ( -- )                                                 cr  10  7 ((/-test)) -10  7 ((/-test))                              10 -7 ((/-test)) -10 -7 ((/-test)) ;                      : /-test ( -- )                                                   dup ['] m/     ['] (/) defer! (/-test)                              ['] sm/rem ['] (/) defer! (/-test) ;                                                                                                                                                                                                                                                                                                                                                                                                                      ( exception-test )                                              need catch                                                      : could-fail ( -- c )                                             key dup 'q' =                                                   if  -1 throw  then ;                                          : do-it ( a b -- c )                                              2drop could-fail ;                                            : try-it ( -- )                                                   1 2 ['] do-it catch                                             if    ( x1 x2 ) 2drop ." There was an exception" cr             else  ." The character was " emit cr then ;                   : retry-it ( -- )                                                 begin   1 2 ['] do-it catch                                     while   ( x1 x2 ) 2drop ." Exception, keep trying" cr           repeat  ( c )                                                   ." The character was " emit cr ;                              ( err>ord )                                                     : err>ord ( -- )                                                  91 1 ?do  i . i error>ordinal ."  -> " . cr  loop               286 256 ?do  i . i error>ordinal ."  -> " . cr  loop            1025 1000 ?do  i . i error>ordinal ."  -> " . cr  loop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ( type-fields-test )                                            need type-left need type-center need type-right                 s" La Mancha" 2constant text                                    : ruler ( -- ) home '-' 32 emits home ;                         : ready ( -- )                                                    0 1 at-xy ." Press any key to continue"                         key drop ruler ;                                              -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( type-fields-test )                                            : test ( -- ) page                                                ready text text nip type-left                                   ready text 32 type-left                                         ready text 5 type-left                                          ready text text nip type-center                                 ready text 32 type-center                                       ready text 5 type-center                                        ready text text nip type-right                                  ready text 32 type-right                                        ready text 5 type-right ;                                     : tc ( ca len1 len2 -- )                                          2dup <=> cells type-center-cases + @ >name .name ;            : tr ( ca len1 len2 -- )                                          2dup <=> cells type-right-cases + @ >name .name ;                                                                             ( ?ccase-test ccase0-test )                                     need ?ccase need ccase0                                         : .a    ( -- ) ." Letter A" ;                                   : .b    ( -- ) ." Letter B" ;                                   : .c    ( -- ) ." Letter C" ;                                   : .nope ( -- ) ." Nope!" ;                                      : .end  ( -- ) ."  The End" cr ;                                : ?letter ( c -- )                                                cr ." ?letter... " key drop                                     s" abc" ?ccase  .a .b .c  end?ccase  .end ;                   'a' ?letter  'b' ?letter  'c' ?letter  'x' ?letter              : letter0 ( c -- )                                                cr ." letter0... " key drop                                     s" abc" ccase0 .nope  .a .b .c  endccase0  .end ;             'a' letter0  'b' letter0  'c' letter0  'x' letter0                                                                              ( ccase-test )                                                  need ccase                                                      : .a    ( -- ) ." Letter A" ;                                   : .b    ( -- ) ." Letter B" ;                                   : .c    ( -- ) ." Letter C" ;                                   : .nope ( -- ) ." Nope!" ;                                      : .end  ( -- ) ."  The End" cr ;                                : letter ( c -- )                                                 cr ." letter... " key drop                                      s" abc" ccase  .a .b .c  .nope  endccase  .end ;              'a' letter  'b' letter  'c' letter  'x' letter                                                                                                                                                                                                                                                                                                                                                  ( begincase-test )                                              need begincase                                                  : test                                                            begincase                                                         cr ." press a key ('2' '4' '9' exits) : " key                   '2' of  ." ... 2 "  endof                                       '4' of  ." ... 4 "  endof                                       '9' of  ." ... 9 "  endof                                         dup emit ."  try again"                                     repeatcase ;                                                                                                                                                                                                                                                                                                                                                                                                                                                  ( jk-test )                                                     need j need k                                                   : jk-test ( -- )                                                  3 0 ?do                                                           13 10 ?do                                                         23 20 ?do                                                         k . j . i . cr                                                loop                                                          loop                                                          loop ;                                                        cr jk-test                                                                                                                                                                                                                                                                                                                                                                                      ( color-test )                                                  need color need permcolor                                       : c? ( ca -- ) c@ . ;                                           : .color ( -- )                                                   cr ." os-attr-t " os-attr-t c?                                  cr ." os-mask-t " os-mask-t c?                                  cr ." os-attr-p " os-attr-p c?                                  cr ." os-mask-p " os-mask-p c? ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( search-test )                                                 256 constant /long-string                                       create long-string /long-string allot                           : -long-string ( -- ) long-string /long-string blank ;          s"  zx " 2constant substring                                    : place-substring ( n -- )                                        -long-string substring rot long-string + 1- swap cmove ;      : search-at ( n -- )                                              dup place-substring long-string swap substring search           .s drop 2drop ;                                               : run ( -- )                                                      cr ." Search at 128:" 128 search-at                             cr ." Search at 64:" 64 search-at                               cr ." Search at 32:" 32 search-at ;                                                                                                                                                           ( foo3 foo4 )                                                   cr .( foo3)                                                     cr .( foo4)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ( need-test foo1 foo2 )                                         need foo3 need [if]                                             [needed] foo1 [if] need foo4                                    cr .( foo1) exit [then]                                         cr .( foo2)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ( ?(-test )                                                     0 dup ?( create zx1a  create zx1b ?)                            1 ?(                                                            \ nope                                                          nope                                                            ?) ?( : zx1c                                                     ." zx1c"                                                        ; : zx1d                                                        ; ?)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( a>e-test )                                                    need u>ud                                                       : high-far ( a1 -- a2 )                                           u>ud $4000 um/mod  far-banks + c@ bank  $C000 + ;             : far-test ( -- )                                                 hex $FFFF 1+ $0000 ?do                                            home i 4 .r  i far i high-far <>                                if  cr ." Mismatch in address " u. abort  then                loop  decimal ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ( lineload-test )                                                 .( line 1 ) cr                                                  .( line 2 ) cr                                                  .( line 3 ) cr                                                  .( line 4 ) cr                                                  .( line 5 ) cr                                                  .( line 6 ) cr                                                  .( line 7 ) cr                                                  .( line 8 ) cr                                                  .( line 9 ) cr                                                  .( line 10 ) cr                                                 .( line 11 ) cr                                                 .( line 12 ) cr                                                 .( line 13 ) cr                                                 .( line 14 ) cr                                                 .( line 15 ) cr                                               ( load-section-test )                                             .( section line 1 ) cr need [if]                                .( section line 2 ) cr                                          .( section line 3 ) cr                                          .( section line 4 ) cr                                          .( section line 5 ) cr                                          .( section line 6 ) cr                                          .( section line 7 ) cr                                          .( section line 8 ) cr                                          .( section line 9 ) cr                                          .( section line 10 ) cr                                         .( section line 11 ) cr                                         .( section line 12 ) cr                                         .( section line 13 ) cr                                         0 [if]  .( section line 14 NOT! ) cr                            .( section line 15 NOT! ) cr                                  .( section line 16 NOT! ) cr                                      .( section line 17 NOT! ) cr [else]                             .( section line 18 ) cr                                         .( section line 19 ) cr                                         .( section line 20 ) cr [then]                                  .( section line 21 ) cr                                         .( section line 22 ) cr                                         .( section line 23 ) cr                                         .( section line 24 ) cr                                         .( section line 25 ) cr                                         .( section line 26 ) cr                                       end-section                                                       .( End of section) cr                                                                                                                                                                                                                                         .( block x line 0)                                                .( block x line 1 ) cr                                          .( block x line 2 ) cr                                          .( block x line 3 ) cr                                          .( block x line 4 ) cr                                          .( block x line 5 ) cr                                          .( block x line 6 ) cr                                          .( block x line 7 ) cr                                          .( block x line 8 ) cr                                          .( block x line 9 ) cr                                          .( block x line 10 ) cr                                         .( block x line 11 ) cr                                         .( block x line 12 ) cr                                         .( block x line 13 ) cr                                         .( block x line 14 ) cr                                         .( block x line 15 ) cr                                       .( block x+1 line 0)                                              .( block x+1 line 1 ) cr                                        .( block x+1 line 2 ) cr                                        .( block x+1 line 3 ) cr                                        .( block x+1 line 4 ) cr                                        .( block x+1 line 5 ) cr                                        .( block x+1 line 6 ) cr                                        .( block x+1 line 7 ) cr                                        .( block x+1 line 8 ) cr                                        .( block x+1 line 9 ) cr                                        .( block x+1 line 10 ) cr                                       .( block x+1 line 11 ) cr                                       .( block x+1 line 12 ) cr                                       .( block x+1 line 13 ) cr                                       .( block x+1 line 14 ) cr                                       .( block x+1 line 15 ) cr                                     ( XXX TMP -- block for temporary tries)                         need thru                                                       blk @ 1+ blk @ 2+ thru                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ( XXX TMP -- block for temporary tries)                         : hello ( -- )                                                   ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( hayes-test )                                                  need hayes-tester need do  verbose on  hex                      { -> }  \ start with clean slate                                { : bitsset? if 0 0 else 0 then ; -> }                          {  0 bitsset? -> 0 } {  1 bitsset? -> 0 0 }                     { -1 bitsset? -> 0 0 }                                          testing( invert and or xor)                                     { 0 0 and -> 0 } { 0 1 and -> 0 }                               { 1 0 and -> 0 } { 1 1 and -> 1 }                               { 0 invert 1 and -> 1 } { 1 invert 1 and -> 0 }                 0  constant 0s  0 invert constant 1s                            { 0s invert -> 1s } { 1s invert -> 0s } { 0s 0s and -> 0s }     { 0s 1s and -> 0s } { 1s 0s and -> 0s } { 1s 1s and -> 1s }     { 0s 0s or -> 0s } { 0s 1s or -> 1s } { 1s 0s or -> 1s }        { 1s 1s or -> 1s } { 0s 0s xor -> 0s } { 0s 1s xor -> 1s }      { 1s 0s xor -> 1s } { 1s 1s xor -> 0s }  -->                    ( hayes-test )                                                  testing( 2* 2/) need rshift need 2/                             1s 1 rshift invert constant msb { msb bitsset? -> 0 0 }         { 0s 2* -> 0s } { 1 2* -> 2 } { 4000 2* -> 8000 }               { 1s 2* 1 xor -> 1s } { msb 2* -> 0s } { 0s 2/ -> 0s }          { 1 2/ -> 0 } { 4000 2/ -> 2000 }                               { 1s 2/ -> 1s }  \ msb propagated                               { 1s 1 xor 2/ -> 1s } { msb 2/ msb and -> msb }  -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( hayes-test )                                                  testing( lshift rshift) need lshift need rshift                 { 1 0 lshift -> 1 } { 1 1 lshift -> 2 } { 1 2 lshift -> 4 }     { 1 f lshift -> 8000 }  \ biggest guaranteed shift              { 1s 1 lshift 1 xor -> 1s } { msb 1 lshift -> 0 }               { 1 0 rshift -> 1 } { 1 1 rshift -> 0 } { 2 1 rshift -> 1 }     { 4 2 rshift -> 1 }                                             { 8000 f rshift -> 1 }  \ biggest                               { msb 1 rshift msb and -> 0 }  \ rshift zero fills msbs         { msb 1 rshift 2* -> msb }  -->                                                                                                                                                                                                                                                                                                                                                                                                                                 ( hayes-test )                                                  testing( 0= = 0< < > u< min max)                                0 invert  constant max-uint                                     0 invert 1 rshift  constant max-int                             0 invert 1 rshift invert  constant min-int                      0 invert 1 rshift  constant mid-uint                            0 invert 1 rshift invert  constant mid-uint+1                   0s constant <false> 1s constant <true>                          { 0 0= -> <true> } { 1 0= -> <false> } { 2 0= -> <false> }      { -1 0= -> <false> } { max-uint 0= -> <false> }                 { min-int 0= -> <false> } { max-int 0= -> <false> }  -->                                                                                                                                                                                                                                                                                                                                        ( hayes-test )                                                  { 0 0 = -> <true> } { 1 1 = -> <true> } { -1 -1 = -> <true> }   { 1 0 = -> <false> } { -1 0 = -> <false> } { 0 1 = -> <false> } { 0 -1 = -> <false> } { 0 0< -> <false> } { -1 0< -> <true> }   { min-int 0< -> <true> } { 1 0< -> <false> }                    { max-int 0< -> <false> } { 0 1 < -> <true> }                   { 1 2 < -> <true> } { -1 0 < -> <true> } { -1 1 < -> <true> }   { min-int 0 < -> <true> } { min-int max-int < -> <true> }       { 0 max-int < -> <true> } { 0 0 < -> <false> }                  { 1 1 < -> <false> } { 1 0 < -> <false> } { 2 1 < -> <false> }  { 0 -1 < -> <false> } { 1 -1 < -> <false> }                     { 0 min-int < -> <false> } { max-int min-int < -> <false> }     { max-int 0 < -> <false> } { 0 1 > -> <false> }                 { 1 2 > -> <false> } { -1 0 > -> <false> }                      { -1 1 > -> <false> } { min-int 0 > -> <false> }                { min-int max-int > -> <false> } { 0 max-int > -> <false> } --> ( hayes-test )                                                  { 0 0 > -> <false> } { 1 1 > -> <false> } { 1 0 > -> <true> }   { 2 1 > -> <true> } { 0 -1 > -> <true> } { 1 -1 > -> <true> }   { 0 min-int > -> <true> } { max-int min-int > -> <true> }       { max-int 0 > -> <true> } { 0 1 u< -> <true> }                  { 1 2 u< -> <true> } { 0 mid-uint u< -> <true> }                { 0 max-uint u< -> <true> } { mid-uint max-uint u< -> <true> }  { 0 0 u< -> <false> } { 1 1 u< -> <false> }                     { 1 0 u< -> <false> } { 2 1 u< -> <false> }                     { mid-uint 0 u< -> <false> } { max-uint 0 u< -> <false> }       { max-uint mid-uint u< -> <false> } { 0 1 min -> 0 }            { 1 2 min -> 1 } { -1 0 min -> -1 } { -1 1 min -> -1 }          { min-int 0 min -> min-int } { min-int max-int min -> min-int } { 0 max-int min -> 0 } { 0 0 min -> 0 } { 1 1 min -> 1 }        { 1 0 min -> 0 } { 2 1 min -> 1 } -->                                                                                           ( hayes-test )                                                  { 0 -1 min -> -1 } { 1 -1 min -> -1 }                           { 0 min-int min -> min-int } { max-int min-int min -> min-int } { max-int 0 min -> 0 } { 0 1 max -> 1 } { 1 2 max -> 2 }        { -1 0 max -> 0 } { -1 1 max -> 1 } { min-int 0 max -> 0 }      { min-int max-int max -> max-int } { 0 max-int max -> max-int } { 0 0 max -> 0 } { 1 1 max -> 1 } { 1 0 max -> 1 }              { 2 1 max -> 2 } { 0 -1 max -> 0 } { 1 -1 max -> 1 }            { 0 min-int max -> 0 } { max-int min-int max -> max-int }       { max-int 0 max -> max-int }  -->                                                                                                                                                                                                                                                                                                                                                                                                                               ( hayes-test )                                                  testing( stack ops)                                             { 1 2 2drop -> } { 1 2 2dup -> 1 2 1 2 }                        { 1 2 3 4 2over -> 1 2 3 4 1 2 } { 1 2 3 4 2swap -> 3 4 1 2 }   { 0 ?dup -> 0 } { 1 ?dup -> 1 1 } { -1 ?dup -> -1 -1 }          { depth -> 0 } { 0 depth -> 0 1 } { 0 1 depth -> 0 1 2 }        { 0 drop -> } { 1 2 drop -> 1 } { 1 dup -> 1 1 }                { 1 2 over -> 1 2 1 } { 1 2 3 rot -> 2 3 1 }                    { 1 2 swap -> 2 1 }                                             testing( >r r> r@)                                              { : gr1 >r r> ; -> } { : gr2 >r r@ r> drop ; -> }               { 123 gr1 -> 123 } { 123 gr2 -> 123 }                           { 1s gr1 -> 1s }  \ return stack holds cells                    -->                                                                                                                                                                                             ( hayes-test )                                                  testing( + - 1+ 1- abs negate)                                  { 0 5 + -> 5 } { 5 0 + -> 5 } { 0 -5 + -> -5 } { -5 0 + -> -5 } { 1 2 + -> 3 } { 1 -2 + -> -1 } { -1 2 + -> 1 }                 { -1 -2 + -> -3 } { -1 1 + -> 0 }                               { mid-uint 1 + -> mid-uint+1 } { 0 5 - -> -5 } { 5 0 - -> 5 }   { 0 -5 - -> 5 } { -5 0 - -> -5 } { 1 2 - -> -1 }                { 1 -2 - -> 3 } { -1 2 - -> -3 } { -1 -2 - -> 1 }               { 0 1 - -> -1 } { mid-uint+1 1 - -> mid-uint } { 0 1+ -> 1 }    { -1 1+ -> 0 } { 1 1+ -> 2 } { mid-uint 1+ -> mid-uint+1 }      { 2 1- -> 1 } { 1 1- -> 0 } { 0 1- -> -1 }                      { mid-uint+1 1- -> mid-uint } { 0 negate -> 0 }                 { 1 negate -> -1 } { -1 negate -> 1 } { 2 negate -> -2 }        { -2 negate -> 2 } { 0 abs -> 0 } { 1 abs -> 1 }                { -1 abs -> 1 } { min-int abs -> mid-uint+1 } -->                                                                               ( hayes-test )                                                  testing( s>d * m* um*)                                          { 0 s>d -> 0 0 } { 1 s>d -> 1 0 } { 2 s>d -> 2 0 }              { -1 s>d -> -1 -1 } { -2 s>d -> -2 -1 }                         { min-int s>d -> min-int -1 } { max-int s>d -> max-int 0 }      { 0 0 m* -> 0 s>d } { 0 1 m* -> 0 s>d } { 1 0 m* -> 0 s>d }     { 1 2 m* -> 2 s>d } { 2 1 m* -> 2 s>d } { 3 3 m* -> 9 s>d }     { -3 3 m* -> -9 s>d } { 3 -3 m* -> -9 s>d }                     { -3 -3 m* -> 9 s>d } { 0 min-int m* -> 0 s>d }                 { 1 min-int m* -> min-int s>d } { 2 min-int m* -> 0 1s }        { 0 max-int m* -> 0 s>d } { 1 max-int m* -> max-int s>d }       { 2 max-int m* -> max-int 1 lshift 0 }                          { min-int min-int m* -> 0 msb 1 rshift }                        { max-int min-int m* -> msb msb 2/ }                            { max-int max-int m* -> 1 msb 2/ invert } -->                                                                                   ( hayes-test )                                                  { 0 0 * -> 0 } { 0 1 * -> 0 } { 1 0 * -> 0 } { 1 2 * -> 2 }     { 2 1 * -> 2 } { 3 3 * -> 9 } { -3 3 * -> -9 } { 3 -3 * -> -9 } { -3 -3 * -> 9 }                                                { mid-uint+1 1 rshift 2 * -> mid-uint+1 }                       { mid-uint+1 2 rshift 4 * -> mid-uint+1 }                       { mid-uint+1 1 rshift mid-uint+1 or 2 * -> mid-uint+1 }         { 0 0 um* -> 0 0 } { 0 1 um* -> 0 0 } { 1 0 um* -> 0 0 }        { 1 2 um* -> 2 0 } { 2 1 um* -> 2 0 } { 3 3 um* -> 9 0 }        { mid-uint+1 1 rshift 2 um* -> mid-uint+1 0 }                   { mid-uint+1 2 um* -> 0 1 } { mid-uint+1 4 um* -> 0 2 }         { 1s 2 um* -> 1s 1 lshift 1 }                                   { max-uint max-uint um* -> 1 1 invert } -->                                                                                                                                                                                                                     ( hayes-test )                                                  testing( fm/mod sm/rem um/mod */ */mod / /mod mod)              need fm/mod                                                     { 0 s>d 1 fm/mod -> 0 0 } { 1 s>d 1 fm/mod -> 0 1 }             { 2 s>d 1 fm/mod -> 0 2 } { -1 s>d 1 fm/mod -> 0 -1 }           { -2 s>d 1 fm/mod -> 0 -2 } { 0 s>d -1 fm/mod -> 0 0 }          { 1 s>d -1 fm/mod -> 0 -1 } { 2 s>d -1 fm/mod -> 0 -2 }         { -1 s>d -1 fm/mod -> 0 1 } { -2 s>d -1 fm/mod -> 0 2 }         { 2 s>d 2 fm/mod -> 0 1 } { -1 s>d -1 fm/mod -> 0 1 }           { -2 s>d -2 fm/mod -> 0 1 } {  7 s>d  3 fm/mod -> 1 2 }  -->                                                                                                                                                                                                                                                                                                                                                                                                    ( hayes-test )                                                  {  7 s>d -3 fm/mod -> -2 -3 } { -7 s>d  3 fm/mod -> 2 -3 }      { -7 s>d -3 fm/mod -> -1 2 }                                    { max-int s>d 1 fm/mod -> 0 max-int }                           { min-int s>d 1 fm/mod -> 0 min-int }                           { max-int s>d max-int fm/mod -> 0 1 }                           { min-int s>d min-int fm/mod -> 0 1 }                           { 1s 1 4 fm/mod -> 3 max-int }                                  { 1 min-int m* 1 fm/mod -> 0 min-int }                          { 1 min-int m* min-int fm/mod -> 0 1 }                          { 2 min-int m* 2 fm/mod -> 0 min-int }                          { 2 min-int m* min-int fm/mod -> 0 2 }                          { 1 max-int m* 1 fm/mod -> 0 max-int }                          { 1 max-int m* max-int fm/mod -> 0 1 }                          { 2 max-int m* 2 fm/mod -> 0 max-int }                          { 2 max-int m* max-int fm/mod -> 0 2 } -->                      ( hayes-test )                                                  { min-int min-int m* min-int fm/mod -> 0 min-int }              { min-int max-int m* min-int fm/mod -> 0 max-int }              { min-int max-int m* max-int fm/mod -> 0 min-int }              { max-int max-int m* max-int fm/mod -> 0 max-int }              { 0 s>d 1 sm/rem -> 0 0 } { 1 s>d 1 sm/rem -> 0 1 }             { 2 s>d 1 sm/rem -> 0 2 } { -1 s>d 1 sm/rem -> 0 -1 }           { -2 s>d 1 sm/rem -> 0 -2 } { 0 s>d -1 sm/rem -> 0 0 }          { 1 s>d -1 sm/rem -> 0 -1 } { 2 s>d -1 sm/rem -> 0 -2 }         { -1 s>d -1 sm/rem -> 0 1 } { -2 s>d -1 sm/rem -> 0 2 }         { 2 s>d 2 sm/rem -> 0 1 } { -1 s>d -1 sm/rem -> 0 1 }           { -2 s>d -2 sm/rem -> 0 1 } {  7 s>d  3 sm/rem -> 1 2 }         {  7 s>d -3 sm/rem -> 1 -2 } { -7 s>d  3 sm/rem -> -1 -2 }      { -7 s>d -3 sm/rem -> -1 2 }                                    { max-int s>d 1 sm/rem -> 0 max-int }                           { min-int s>d 1 sm/rem -> 0 min-int } -->                       ( hayes-test )                                                  { max-int s>d max-int sm/rem -> 0 1 }                           { min-int s>d min-int sm/rem -> 0 1 }                           { 1s 1 4 sm/rem -> 3 max-int }                                  { 2 min-int m* 2 sm/rem -> 0 min-int }                          { 2 min-int m* min-int sm/rem -> 0 2 }                          { 2 max-int m* 2 sm/rem -> 0 max-int }                          { 2 max-int m* max-int sm/rem -> 0 2 }                          { min-int min-int m* min-int sm/rem -> 0 min-int }              { min-int max-int m* min-int sm/rem -> 0 max-int }              { min-int max-int m* max-int sm/rem -> 0 min-int }              { max-int max-int m* max-int sm/rem -> 0 max-int }              { 0 0 1 um/mod -> 0 0 } { 1 0 1 um/mod -> 0 1 }                 { 1 0 2 um/mod -> 1 0 } { 3 0 2 um/mod -> 1 1 }                 { max-uint 2 um* 2 um/mod -> 0 max-uint }                       { max-uint 2 um* max-uint um/mod -> 0 2 } -->                   ( hayes-test )                                                  { max-uint max-uint um* max-uint um/mod -> 0 max-uint }         : iffloored                                                       [ -3 2 / -2 = invert ] literal if postpone \ then ;           : ifsym                                                           [ -3 2 / -1 = invert ] literal if postpone \ then ;           iffloored : t/mod  >r s>d r> fm/mod ;                           iffloored : t/  t/mod swap drop ;                               iffloored : tmod  t/mod drop ;                                  iffloored : t*/mod >r m* r> fm/mod ;                            iffloored : t*/  t*/mod swap drop ;                             ifsym  : t/mod  >r s>d r> sm/rem ;                              ifsym  : t/  t/mod swap drop ;                                  ifsym  : tmod  t/mod drop ;                                     ifsym  : t*/mod >r m* r> sm/rem ;                               ifsym  : t*/  t*/mod swap drop ; -->                            ( hayes-test )                                                  { 0 1 /mod -> 0 1 t/mod } { 1 1 /mod -> 1 1 t/mod }             { 2 1 /mod -> 2 1 t/mod } { -1 1 /mod -> -1 1 t/mod }           { -2 1 /mod -> -2 1 t/mod } { 0 -1 /mod -> 0 -1 t/mod }         { 1 -1 /mod -> 1 -1 t/mod } { 2 -1 /mod -> 2 -1 t/mod }         { -1 -1 /mod -> -1 -1 t/mod } { -2 -1 /mod -> -2 -1 t/mod }     { 2 2 /mod -> 2 2 t/mod } { -1 -1 /mod -> -1 -1 t/mod }         { -2 -2 /mod -> -2 -2 t/mod } { 7 3 /mod -> 7 3 t/mod }         { 7 -3 /mod -> 7 -3 t/mod } { -7 3 /mod -> -7 3 t/mod }         { -7 -3 /mod -> -7 -3 t/mod }                                   { max-int 1 /mod -> max-int 1 t/mod }                           { min-int 1 /mod -> min-int 1 t/mod }                           { max-int max-int /mod -> max-int max-int t/mod }               { min-int min-int /mod -> min-int min-int t/mod } -->                                                                                                                                           ( hayes-test )                                                  { 0 1 / -> 0 1 t/ } { 1 1 / -> 1 1 t/ } { 2 1 / -> 2 1 t/ }     { -1 1 / -> -1 1 t/ } { -2 1 / -> -2 1 t/ }                     { 0 -1 / -> 0 -1 t/ } { 1 -1 / -> 1 -1 t/ }                     { 2 -1 / -> 2 -1 t/ } { -1 -1 / -> -1 -1 t/ }                   { -2 -1 / -> -2 -1 t/ } { 2 2 / -> 2 2 t/ }                     { -1 -1 / -> -1 -1 t/ } { -2 -2 / -> -2 -2 t/ }                 { 7 3 / -> 7 3 t/ } { 7 -3 / -> 7 -3 t/ }                       { -7 3 / -> -7 3 t/ } { -7 -3 / -> -7 -3 t/ }                   { max-int 1 / -> max-int 1 t/ }                                 { min-int 1 / -> min-int 1 t/ }                                 { max-int max-int / -> max-int max-int t/ }                     { min-int min-int / -> min-int min-int t/ }                     { 0 1 mod -> 0 1 tmod } { 1 1 mod -> 1 1 tmod }                 { 2 1 mod -> 2 1 tmod } { -1 1 mod -> -1 1 tmod }               { -2 1 mod -> -2 1 tmod } { 0 -1 mod -> 0 -1 tmod }  -->        ( hayes-test )                                                  { 1 -1 mod -> 1 -1 tmod } { 2 -1 mod -> 2 -1 tmod }             { -1 -1 mod -> -1 -1 tmod } { -2 -1 mod -> -2 -1 tmod }         { 2 2 mod -> 2 2 tmod } { -1 -1 mod -> -1 -1 tmod }             { -2 -2 mod -> -2 -2 tmod } { 7 3 mod -> 7 3 tmod }             { 7 -3 mod -> 7 -3 tmod } { -7 3 mod -> -7 3 tmod }             { -7 -3 mod -> -7 -3 tmod } { max-int 1 mod -> max-int 1 tmod } { min-int 1 mod -> min-int 1 tmod }                             { max-int max-int mod -> max-int max-int tmod }                 { min-int min-int mod -> min-int min-int tmod }                 { 0 2 1 */ -> 0 2 1 t*/ } { 1 2 1 */ -> 1 2 1 t*/ }             { 2 2 1 */ -> 2 2 1 t*/ } { -1 2 1 */ -> -1 2 1 t*/ }           { -2 2 1 */ -> -2 2 1 t*/ } { 0 2 -1 */ -> 0 2 -1 t*/ }         { 1 2 -1 */ -> 1 2 -1 t*/ } { 2 2 -1 */ -> 2 2 -1 t*/ }         { -1 2 -1 */ -> -1 2 -1 t*/ } { -2 2 -1 */ -> -2 2 -1 t*/ }     { 2 2 2 */ -> 2 2 2 t*/ }  -->                                  ( hayes-test )                                                  { -1 2 -1 */ -> -1 2 -1 t*/ } { -2 2 -2 */ -> -2 2 -2 t*/ }     { 7 2 3 */ -> 7 2 3 t*/ } { 7 2 -3 */ -> 7 2 -3 t*/ }           { -7 2 3 */ -> -7 2 3 t*/ } { -7 2 -3 */ -> -7 2 -3 t*/ }       { max-int 2 max-int */ -> max-int 2 max-int t*/ }               { min-int 2 min-int */ -> min-int 2 min-int t*/ }               { 0 2 1 */mod -> 0 2 1 t*/mod } { 1 2 1 */mod -> 1 2 1 t*/mod } { 2 2 1 */mod -> 2 2 1 t*/mod }                                 { -1 2 1 */mod -> -1 2 1 t*/mod }                               { -2 2 1 */mod -> -2 2 1 t*/mod }                               { 0 2 -1 */mod -> 0 2 -1 t*/mod }                               { 1 2 -1 */mod -> 1 2 -1 t*/mod }                               { 2 2 -1 */mod -> 2 2 -1 t*/mod }                               { -1 2 -1 */mod -> -1 2 -1 t*/mod }                             { -2 2 -1 */mod -> -2 2 -1 t*/mod }                             { 2 2 2 */mod -> 2 2 2 t*/mod } -->                             ( hayes-test )                                                  { -1 2 -1 */mod -> -1 2 -1 t*/mod }                             { -2 2 -2 */mod -> -2 2 -2 t*/mod }                             { 7 2 3 */mod -> 7 2 3 t*/mod }                                 { 7 2 -3 */mod -> 7 2 -3 t*/mod }                               { -7 2 3 */mod -> -7 2 3 t*/mod }                               { -7 2 -3 */mod -> -7 2 -3 t*/mod }                             { max-int 2 max-int */mod -> max-int 2 max-int t*/mod }         { min-int 2 min-int */mod -> min-int 2 min-int t*/mod }         testing( here , @ ! cell+ cells c, c@ c! chars 2@ 2! +! aligned align allot)                                                    here 1 allot here constant 2nda constant 1sta                   { 1sta 2nda u< -> <true> } { 1sta 1+ -> 2nda }                  -->                                                                                                                                                                                             ( hayes-test )                                                  here 1 , here 2 , constant 2nd constant 1st                     { 1st 2nd u< -> <true> } { 1st cell+ -> 2nd }                   { 1st 1 cells + -> 2nd } { 1st @ 2nd @ -> 1 2 } { 5 1st ! -> }  { 1st @ 2nd @ -> 5 2 } { 6 2nd ! -> } { 1st @ 2nd @ -> 5 6 }    { 1st 2@ -> 6 5 } { 2 1 1st 2! -> } { 1st 2@ -> 2 1 }           { 1s 1st !  1st @ -> 1s }  \ can store cell-wide value          here 1 c, here 2 c, constant 2ndc constant 1stc                 { 1stc 2ndc u< -> <true> } { 1stc char+ -> 2ndc }               { 1stc 1 chars + -> 2ndc } { 1stc c@ 2ndc c@ -> 1 2 }           { 3 1stc c! -> } { 1stc c@ 2ndc c@ -> 3 2 }                     { 4 2ndc c! -> } { 1stc c@ 2ndc c@ -> 3 4 }                     -->                                                                                                                                                                                                                                                             ( hayes-test )                                                  need align need aligned                                         align 1 allot here align here 3 cells allot                     constant a-addr  constant ua-addr                               { ua-addr aligned -> a-addr }                                   {  1 a-addr c!  a-addr c@ ->  1 }                               { 1234 a-addr  !  a-addr  @ -> 1234 }                           { 123 456 a-addr 2!  a-addr 2@ -> 123 456 }                     { 2 a-addr char+ c!  a-addr char+ c@ -> 2 }                     { 3 a-addr cell+ c!  a-addr cell+ c@ -> 3 }                     { 1234 a-addr cell+ !  a-addr cell+ @ -> 1234 }                 { 123 456 a-addr cell+ 2!  a-addr cell+ 2@ -> 123 456 }         -->                                                                                                                                                                                                                                                             ( hayes-test )                                                  : bits ( x -- u )                                                 0 swap begin   dup                                                     while   dup msb and if  >r 1+ r>  then  2*                      repeat  drop ;                                         { 1 chars 1 < -> <false> } { 1 chars 1 cells > -> <false> }     { 1 cells 1 < -> <false> } { 1 cells 1 chars mod -> 0 }         { 1s bits 10 < -> <false> }                                     { 0 1st ! -> } { 1 1st +! -> } { 1st @ -> 1 }                   { -1 1st +! 1st @ -> 0 }                                        testing( char [char] [ ] bl s") need char need [char]           { bl -> 20 } { char X -> 58 } { char HELLO -> 48 }              { : gc1 [char] X ; -> } { : gc2 [char] HELLO ; -> }             { gc1 -> 58 } { gc2 -> 48 } { : gc3 [ gc1 ] literal ; -> }      { gc3 -> 58 } { : gc4 s" XY" ; -> } { gc4 swap drop -> 2 }      { gc4 drop dup c@ swap char+ c@ -> 58 59 } -->                  ( hayes-test )                                                  testing( ' ['] find execute immediate count literal postpone    state)                                                          need find                                                       { : gt1 123 ; -> } { ' gt1 execute -> 123 }                     { : gt2 ['] gt1 ; immediate -> } { gt2 execute -> 123 }         here 3 c, char G c, char T c, char 1 c, constant gt1string      here 3 c, char G c, char T c, char 2 c, constant gt2string      { gt1string find -> ' gt1 -1 } { gt2string find -> ' gt2 1 }    { : gt3 gt2 literal ; -> } { gt3 -> ' gt1 }                     { gt1string count -> gt1string char+ 3 }                        { : gt4 postpone gt1 ; immediate -> } { : gt5 gt4 ; -> }        { gt5 -> 123 } { : gt6 345 ; immediate -> }                     { : gt7 postpone gt6 ; -> } { gt7 -> 345 }                      { : gt8 state @ ; immediate -> } { gt8 -> 0 }                   { : gt9 gt8 literal ; -> } { gt9 0= -> <false> } -->            ( hayes-test )                                                  testing( if else then)                                          { : gi1 if 123 then ; -> } { : gi2 if 123 else 234 then ; -> }  { 0 gi1 -> } { 1 gi1 -> 123 } { -1 gi1 -> 123 }                 { 0 gi2 -> 234 } { 1 gi2 -> 123 } { -1 gi1 -> 123 }             testing( begin while repeat until recurse)                      { : gi3 begin dup 5 < while dup 1+ repeat ; -> }                { 0 gi3 -> 0 1 2 3 4 5 }                                        { 4 gi3 -> 4 5 } { 5 gi3 -> 5 } { 6 gi3 -> 6 }                  { : gi4 begin dup 1+ dup 5 > until ; -> }                       { 3 gi4 -> 3 4 5 6 } { 5 gi4 -> 5 6 } { 6 gi4 -> 6 7 }          { : gi5 begin dup 2 >                                               while dup 5 < while dup 1+ repeat 123 else 345 then ; -> }  { 1 gi5 -> 1 345 }      { 2 gi5 -> 2 345 }                      { 3 gi5 -> 3 4 5 123 }  { 4 gi5 -> 4 5 123 }                    { 5 gi5 -> 5 123 }  -->                                         ( hayes-test )                                                  testing( recurse) need recurse                                  { : gi6 ( n -- 0,1,..n ) dup if dup >r 1- recurse r> then ;     -> }                                                            { 0 gi6 -> 0 } { 1 gi6 -> 0 1 } { 2 gi6 -> 0 1 2 }              { 3 gi6 -> 0 1 2 3 } { 4 gi6 -> 0 1 2 3 4 }                     testing( do loop +loop i j unloop leave exit) need j            { : gd1 do i loop ; -> } { 4 1 gd1 -> 1 2 3 }                   { 2 -1 gd1 -> -1 0 1 } { mid-uint+1 mid-uint gd1 -> mid-uint }  { : gd2 do i -1 +loop ; -> } { 1 4 gd2 -> 4 3 2 1 }             { -1 2 gd2 -> 2 1 0 -1 }                                        { mid-uint mid-uint+1 gd2 -> mid-uint+1 mid-uint }              { : gd3 do 1 0 do j loop loop ; -> }                            { 4 1 gd3 -> 1 2 3 } { 2 -1 gd3 -> -1 0 1 }                     { mid-uint+1 mid-uint gd3 -> mid-uint } -->                                                                                     ( hayes-test )                                                  { : gd4 do 1 0 do j loop -1 +loop ; -> }                        { 1 4 gd4 -> 4 3 2 1 }                                          { -1 2 gd4 -> 2 1 0 -1 }                                        { mid-uint mid-uint+1 gd4 -> mid-uint+1 mid-uint }              { : gd5 123 swap 0 do i 4 > if drop 234 leave then loop ; -> }  { 1 gd5 -> 123 } { 5 gd5 -> 123 } { 6 gd5 -> 234 }              { : gd6                                                             0 swap 0 do                                                     i 1+ 0 do i j + 3 = if i unloop i unloop exit then 1+ loop      loop ; -> }                                                 { 1 gd6 -> 1 }  { 2 gd6 -> 3 }  { 3 gd6 -> 4 1 2 } -->                                                                                                                                                                                                                                                                          ( hayes-test )                                                  testing( : ; constant variable create does> >body)              need >body                                                      { 123 constant x123 -> } { x123 -> 123 }                        { : equ constant ; -> } { x123 equ y123 -> } { y123 -> 123 }    { variable v1 -> } { 123 v1 ! -> } { v1 @ -> 123 }              { : nop : postpone ; ; -> }                                     { nop nop1 nop nop2 -> } { nop1 -> } { nop2 -> }                { : does1 does> @ 1 + ; -> } { : does2 does> @ 2 + ; -> }       { create cr1 -> } { cr1 -> here }                               { ' cr1 >body -> here }                                         { 1 , -> } { cr1 @ -> 1 } { does1 -> }                          { cr1 -> 2 } { does2 -> } { cr1 -> 3 }                          { : weird: create does> 1 + does> 2 + ; -> }                    { weird: w1 -> } { ' w1 >body -> here }                         { w1 -> here 1 + } { w1 -> here 2 + }  -->                      ( hayes-test )                                                  testing( evaluate)                                              need evaluate                                                   : ge1 s" 123" ; immediate   : ge2 s" 123 1+" ; immediate        : ge3 s" : ge4 345 ;" ;     : ge5 evaluate ; immediate          { ge1 evaluate -> 123 } { ge2 evaluate -> 124 }                 { ge3 evaluate -> } { ge4 -> 345 }                              { : ge6 ge1 ge5 ; -> } { ge6 -> 123 }                           { : ge7 ge2 ge5 ; -> } { ge7 -> 124 }                           testing( source >in word)                                       : gs1 s" SOURCE" 2dup evaluate >r swap >r = r> r> = ;           { gs1 -> <true> <true> }                                        variable scans  2 scans !                                       : rescan?  -1 scans +! scans @ if 0 >in ! then ;                -->                                                                                                                             ( hayes-test )                                                  { 345 rescan?  -> 345 345 }                                     : gs2  5 scans ! s" 123 RESCAN?" evaluate ;                     -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( hayes-test )                                                  { gs2 -> 123 123 123 123 123 }                                  need word                                                       : gs3 word count swap c@ ;                                      { bl gs3 HELLO -> 5 char H }                                    { char " gs3 GOODBYE" -> 7 char G }                             need +thru need continued  1 2 +thru  blk @ 3 + continued                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ( hayes-test )                                                  \ line 1                                                        \ line 2                                                        \ line 3                                                        \ line 4                                                        \ line 5                                                        \ line 6                                                        \ line 7                                                        \ line 8                                                        \ line 9                                                        \ line 10                                                       \ line 11                                                       \ line 12                                                       \ line 13                                                       \ line 14                                                                                                              { bl gs3 ( hayes-test )                                                  drop -> 0 }  \ blank line return zero-length string             : gs4 source >in ! drop ;                                       { gs4 123 456                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ( hayes-test )                                                  -> }                                                            testing( <# # #s #> hold sign base >number hex decimal)         : s=  \ ( addr1 c1 addr2 c2 -- t/f ) compare two strings.         >r swap r@ = if  \ make sure strings have same length           r> ?dup if  \ if non-empty strings                                0 do  over c@ over c@ - if  2drop <false> unloop exit  then           swap char+ swap char+  loop                             then  2drop <true>  \ if we get here, strings match             else  r> drop 2drop <false>  then ; \ lengths mismatch        : gp1  <# 41 hold 42 hold 0 0 #> s" BA" s= ; { gp1 -> <true> }  : gp2  <# -1 sign 0 sign -1 sign 0 0 #> s" --" s= ;             { gp2 -> <true> }                                               : gp3  <# 1 0 # # #> s" 01" s= ; { gp3 -> <true> }              : gp4  <# 1 0 #s #> s" 1" s= ; { gp4 -> <true> } -->                                                                            ( hayes-test )                                                  24 constant max-base  \ base 2 .. 36                            : count-bits                                                      0 0 invert begin dup while >r 1+ r> 2* repeat drop ;          count-bits 2* constant #bits-ud  \ number of bits in ud         : gp5                                                             base @ <true>                                                   max-base 1+ 2 do  \ for each possible base                        i base !  \ tbd: assumes base works                             i 0 <# #s #> s" 10" s= and                                    loop  swap base ! ;  { gp5 -> <true> } -->                                                                                                                                                                                                                                                                                                                                                    ( hayes-test )                                                  : gp6                                                             base @ >r  2 base !                                             max-uint max-uint <# #s #>  \ maximum ud to binary              r> base !  \ s: c-addr u                                        dup #bits-ud = swap 0 do  \ s: c-addr flag                                              over c@ [char] 1 = and  \ all ones                              >r char+ r>                                                   loop swap drop ;  { gp6 -> <true> }     : gp7                                                             base @ >r  max-base base !  <true>                              a 0 do  i 0 <# #s #>  1 = swap c@ i 30 + = and and  loop        max-base a do                                                     i 0 <# #s #>  1 = swap c@ 41 i a - + = and and                loop  r> base ! ;  { gp7 -> <true> }  -->                                                                                     ( hayes-test )                                                  create gn-buf 0 c,                                              : gn-string  gn-buf 1 ;                                         : gn-consumed  gn-buf char+ 0 ;                                 : gn'  [char] ' word char+ c@ gn-buf c!  gn-string ;            { 0 0 gn' 0' >number -> 0 0 gn-consumed }                       { 0 0 gn' 1' >number -> 1 0 gn-consumed }                       { 1 0 gn' 1' >number -> base @ 1+ 0 gn-consumed }               { 0 0 gn' -' >number -> 0 0 gn-string }                         { 0 0 gn' +' >number -> 0 0 gn-string }                         { 0 0 gn' .' >number -> 0 0 gn-string }                         -->                                                                                                                                                                                                                                                                                                                             ( hayes-test )                                                  : >number-based                                                   base @ >r base ! >number r> base ! ;                          { 0 0 gn' 2' 10 >number-based -> 2 0 gn-consumed }              { 0 0 gn' 2'  2 >number-based -> 0 0 gn-string }                { 0 0 gn' f' 10 >number-based -> f 0 gn-consumed }              { 0 0 gn' g' 10 >number-based -> 0 0 gn-string }                { 0 0 gn' g' max-base >number-based -> 10 0 gn-consumed }       { 0 0 gn' z' max-base >number-based -> 23 0 gn-consumed }       -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( hayes-test )                                                  : gn1 ( ud base -- ud' len )                                      base @ >r base !                                                <# #s #>                                                        0 0 2swap >number swap drop  \ return length only               r> base ! ;                                                   { 0 0 2 gn1 -> 0 0 0 }                                          { max-uint 0 2 gn1 -> max-uint 0 0 }                            { max-uint dup 2 gn1 -> max-uint dup 0 }                        { 0 0 max-base gn1 -> 0 0 0 }                                   { max-uint 0 max-base gn1 -> max-uint 0 0 }                     { max-uint dup max-base gn1 -> max-uint dup 0 }                 : gn2  \ ( -- 16 10 )                                             base @ >r  hex base @  decimal base @  r> base ! ;            { gn2 -> 10 a } -->                                                                                                             ( hayes-test )                                                  testing( fill move)                                             create fbuf 00 c, 00 c, 00 c,                                   create sbuf 12 c, 34 c, 56 c,                                   : seebuf fbuf c@  fbuf char+ c@  fbuf char+ char+ c@ ;          { fbuf 0 20 fill -> } { seebuf -> 00 00 00 }                    { fbuf 1 20 fill -> } { seebuf -> 20 00 00 }                    { fbuf 3 20 fill -> } { seebuf -> 20 20 20 }                    { fbuf fbuf 3 chars move -> } { seebuf -> 20 20 20 }            { sbuf fbuf 0 chars move -> } { seebuf -> 20 20 20 }            { sbuf fbuf 1 chars move -> } { seebuf -> 12 20 20 }            { sbuf fbuf 3 chars move -> } { seebuf -> 12 34 56 }            { fbuf fbuf char+ 2 chars move -> } { seebuf -> 12 12 34 }      { fbuf char+ fbuf 2 chars move -> } { seebuf -> 12 34 34 } -->                                                                                                                                  ( hayes-test )                                                  testing( . ." cr emit space spaces type u.)                     : output-test                                                     ." You should see the standard graphic characters:" cr          41 bl do i emit loop cr 61 41 do i emit loop cr                 7F 61 do i emit loop cr                                         ." You should see 0-9 separated by a space:" cr                 9 1+ 0 do i . loop cr                                           ." You should see 0-9 (with no spaces):" cr                     [char] 9 1+ [char] 0 do i 0 spaces emit loop cr                 ." You should see A-G separated by a space:" cr                 [char] G 1+ [char] A do i emit space loop cr                    ." You should see 0-5 separated by two spaces:" cr              5 1+ 0 do i [char] 0 + emit 2 spaces loop cr                  -->                                                                                                                             ( hayes-test )                                                    ." You should see two separate lines:" cr                       s" line 1" type cr s" line 2" type cr                           ." You should see the number ranges" cr                         ." of signed and unsigned numbers:" cr                          ."   signed: " min-int . max-int . cr                           ." unsigned: " 0 u. max-uint u. cr ;  { output-test -> }      testing( accept)                                                create abuf 80 chars allot                                      : accept-test                                                     cr ." Please type up to 80 characters:" cr  abuf 80 accept      cr ." Received: " [char] " emit                                 abuf swap type [char] " emit cr ;  { accept-test -> }         testing( dictionary search rules)                               { : gdx  123 ; : gdx  gdx 234 ; -> } { gdx -> 123 234 }         decimal cr .( Test passed) cr                                   ( hayes-tester )                                                need where need do                                              variable verbose  verbose off                                   : testing( ( "ccc<paren>" -- )                                    verbose @ if    cr ." Testing " postpone .(  exit  then                   postpone ( ;                                        : empty-stack ( i*x -- )                                          depth ?dup if  dup 0< if    negate 0 do  0  loop                                      else  0 do  drop  loop  then  then ;    : test-error ( -- )                                               cr ." Use WHERE to see the error line." empty-stack  abort ;  variable actual-depth  \ stack record                           create actual-results $20 cells allot                           : { ( -- ) ;  \ syntactic sugar.                                -->                                                                                                                             ( hayes-tester )                                                : -> ( i*x -- )                                                   depth dup actual-depth !  \ record depth                        ?dup if  0 do actual-results i cells + ! loop  then ;         : } ( ... -- )                                                    depth actual-depth @ = if  \ depths match                         depth ?dup if  \ there is something on the stack                  0 do  \ for each stack item                                       actual-results i cells + @                                      <> if  cr ." Incorrect result" test-error leave  then         loop                                                          then                                                          else  cr ." Wrong number of results:"                                 cr ." Expected=" depth . cr ." Actual=" actual-depth ?          test-error                                                then ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        